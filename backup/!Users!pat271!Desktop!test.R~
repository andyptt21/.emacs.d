#Loading the rvest package
library('rvest')

#Specifying the url for desired website to be scraped
url <- 'https://www.imdb.com/title/tt0417299/episodes?season=3&ref_=ttep_ep_sn_nx'

show_scraper <- function(url){
    webpage <- read_html(url)

    ##Using CSS selectors to scrap the rankings section
    rank_data_html <- html_nodes(webpage,'.ipl-rating-star__rating')

    ##Converting the ranking data to text
    rank_data <- html_text(rank_data_html)

    rank_data = as.numeric(t(matrix(rank_data,nrow=23))[,1])
    return(rank_data)
}

avatar_urls<-c('https://www.imdb.com/title/tt0417299/episodes?season=1&ref_=ttep_ep_sn_nx',
               'https://www.imdb.com/title/tt0417299/episodes?season=2&ref_=ttep_ep_sn_nx',
               'https://www.imdb.com/title/tt0417299/episodes?season=3&ref_=ttep_ep_sn_nx')
korra_urls<-c('https://www.imdb.com/title/tt1695360/episodes?season=1&ref_=ttep_ep_sn_nx',
              'https://www.imdb.com/title/tt1695360/episodes?season=2&ref_=ttep_ep_sn_nx',
              'https://www.imdb.com/title/tt1695360/episodes?season=3&ref_=ttep_ep_sn_nx',
              'https://www.imdb.com/title/tt1695360/episodes?season=4&ref_=ttep_ep_sn_nx')

avatar_ratings <- sapply(avatar_urls,show_scraper)
korra_ratings <- sapply(korra_urls,show_scraper)
