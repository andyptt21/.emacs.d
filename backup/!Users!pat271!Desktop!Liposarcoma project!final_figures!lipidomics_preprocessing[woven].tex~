\documentclass{article}\usepackage[]{graphicx}\usepackage[]{color}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
%\renewenvironment{knitrout}{\begin{minipage}{\columnwidth}}{\end{minipage}}
\usepackage[margin=0.75in]{geometry}
%\usepackage{listings}
%\usepackage[backend=bibtex,sorting=none]{biblatex}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
%\usepackage[table]{xcolor}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage[normalem]{ulem}
\usepackage{lscape}
\newcommand{\blandscape}{\begin{landscape}}
\newcommand{\elandscape}{\end{landscape}}
\title{Lipidomics figures for liposarcoma paper}
\author{Andrew Patt}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'opts\_chunk' not found}}\end{kframe}
\end{knitrout}

\maketitle

This document is being made since I have concerns about normalization,
samples being merged across modes properly, and if the sequence of
analyses was done properly. Hopefully the results I obtain from this
analysis will be identical to the previous results.

The correct order of analyses should be:
\begin{enumerate}
  \item Normalize
  \item Log transform
  \item Statistics
\end{enumerate}






\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{setwd}\hlstd{(}\hlstr{"~/Desktop/Liposarcoma project/Lipidyzer/"}\hlstd{)}
\hlstd{sample_IDs}\hlkwb{<-}\hlkwd{read.csv}\hlstd{(}\hlstr{"~/Desktop/Liposarcoma project/Lipidyzer/Sample_IDs.csv"}\hlstd{)}
\hlstd{sample_info}\hlkwb{<-}\hlkwd{read.csv}\hlstd{(}\hlstr{"Cell_Run_Order.csv"}\hlstd{)}

\hlstd{mdm2lo_groups}\hlkwb{=}\hlkwd{c}\hlstd{(}\hlstr{"863"}\hlstd{,}\hlstr{"815"}\hlstd{)}
\hlstd{mdm2hi_groups}\hlkwb{=}\hlkwd{c}\hlstd{(}\hlstr{"224"}\hlstd{,}\hlstr{"224A"}\hlstd{,}\hlstr{"224B"}\hlstd{,}\hlstr{"246"}\hlstd{,}\hlstr{"141"}\hlstd{)}

\hlstd{MDM2_status}\hlkwb{<-}\hlkwd{sapply}\hlstd{(sample_info}\hlopt{$}\hlstd{CellLine,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwa{if} \hlstd{(x} \hlopt{%in%} \hlstd{mdm2lo_groups)\{}\hlkwd{return}\hlstd{(}\hlstr{"Low"}\hlstd{)\}} \hlkwa{else if} \hlstd{(x} \hlopt{%in%} \hlstd{mdm2hi_groups)\{}\hlkwd{return}\hlstd{(}\hlstr{"High"}\hlstd{)\}} \hlkwa{else} \hlkwd{return}\hlstd{(}\hlnum{NA}\hlstd{))}
\hlstd{MDM2_status}\hlkwb{<-}\hlkwd{data.frame}\hlstd{(}\hlkwc{Number}\hlstd{=sample_info}\hlopt{$}\hlstd{Number,MDM2_status)}
\hlstd{MDM2_status}\hlkwb{<-}\hlstd{MDM2_status[}\hlopt{-}\hlkwd{which}\hlstd{(MDM2_status}\hlopt{$}\hlstd{Number}\hlopt{==}\hlstr{"Pool"}\hlstd{),]}

\hlstd{treatment_status}\hlkwb{<-}\hlkwd{data.frame}\hlstd{(}\hlkwc{Number}\hlstd{=sample_info}\hlopt{$}\hlstd{Number,sample_info}\hlopt{$}\hlstd{Treatment)}
\hlstd{treatment_status}\hlkwb{<-}\hlstd{treatment_status[}\hlopt{-}\hlkwd{which}\hlstd{(treatment_status}\hlopt{$}\hlstd{Number}\hlopt{==}\hlstr{"Pool"}\hlstd{),]}

\hlstd{NEG_Numbers}\hlkwb{<-}\hlkwd{c}\hlstd{()}
\hlkwa{for}\hlstd{(i} \hlkwa{in} \hlnum{1}\hlopt{:}\hlnum{85}\hlstd{)\{}
  \hlstd{NEG_Numbers}\hlkwb{<-}\hlkwd{c}\hlstd{(NEG_Numbers,}\hlkwd{strsplit}\hlstd{(}\hlkwd{strsplit}\hlstd{(}\hlkwd{as.character}\hlstd{(sample_IDs}\hlopt{$}\hlstd{NEGATIVE[i]),}\hlstr{"_"}\hlstd{)[[}\hlnum{1}\hlstd{]][}\hlnum{2}\hlstd{],}\hlstr{"-"}\hlstd{)[[}\hlnum{1}\hlstd{]][}\hlnum{1}\hlstd{])}
\hlstd{\}}

\hlstd{NEG_Cell_Lines}\hlkwb{<-}\hlkwd{c}\hlstd{()}
\hlkwa{for}\hlstd{(i} \hlkwa{in} \hlnum{1}\hlopt{:}\hlnum{85}\hlstd{)\{}
  \hlstd{NEG_Cell_Lines}\hlkwb{<-}\hlkwd{c}\hlstd{(NEG_Cell_Lines,}\hlkwd{strsplit}\hlstd{(}\hlkwd{as.character}\hlstd{(sample_IDs}\hlopt{$}\hlstd{NEGATIVE[i]),}\hlstr{"-"}\hlstd{)[[}\hlnum{1}\hlstd{]][}\hlnum{2}\hlstd{])}
\hlstd{\}}

\hlstd{NEG_MDM2_Status}\hlkwb{<-}\hlkwd{c}\hlstd{()}
\hlkwa{for}\hlstd{(i} \hlkwa{in} \hlstd{NEG_Cell_Lines)\{}
  \hlstd{index}\hlkwb{<-}\hlkwd{match}\hlstd{(i,sample_info}\hlopt{$}\hlstd{Number)}
  \hlstd{NEG_MDM2_Status}\hlkwb{<-}\hlkwd{c}\hlstd{(NEG_MDM2_Status,}\hlkwd{as.character}\hlstd{(sample_info}\hlopt{$}\hlstd{CellLine[index]))}
\hlstd{\}}

\hlstd{NEG_MDM2_Status}\hlkwb{<-}\hlkwd{sapply}\hlstd{(NEG_MDM2_Status,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwa{if} \hlstd{(x} \hlopt{%in%} \hlstd{mdm2lo_groups)\{}\hlkwd{return}\hlstd{(}\hlstr{"Low"}\hlstd{)\}} \hlkwa{else if} \hlstd{(x} \hlopt{%in%} \hlstd{mdm2hi_groups)\{}\hlkwd{return}\hlstd{(}\hlstr{"High"}\hlstd{)\}} \hlkwa{else} \hlkwd{return}\hlstd{(}\hlnum{NA}\hlstd{))}

\hlstd{NEG_Treatment_Status}\hlkwb{<-}\hlkwd{c}\hlstd{()}
\hlkwa{for}\hlstd{(i} \hlkwa{in} \hlstd{NEG_Cell_Lines)\{}
  \hlstd{index}\hlkwb{<-}\hlkwd{match}\hlstd{(i,sample_info}\hlopt{$}\hlstd{Number)}
  \hlstd{NEG_Treatment_Status}\hlkwb{<-}\hlkwd{c}\hlstd{(NEG_Treatment_Status,}\hlkwd{as.character}\hlstd{(sample_info}\hlopt{$}\hlstd{Treatment[index]))}
\hlstd{\}}

\hlstd{NEG_medium}\hlkwb{<-}\hlkwd{c}\hlstd{()}
\hlkwa{for}\hlstd{(i} \hlkwa{in} \hlstd{NEG_Cell_Lines)\{}
  \hlstd{index}\hlkwb{<-}\hlkwd{match}\hlstd{(i,sample_info}\hlopt{$}\hlstd{Number)}
  \hlstd{NEG_medium}\hlkwb{<-}\hlkwd{c}\hlstd{(NEG_medium,}\hlkwd{as.character}\hlstd{(sample_info}\hlopt{$}\hlstd{Media[index]))}
\hlstd{\}}

\hlstd{NEG_sample_info}\hlkwb{<-}\hlkwd{data.frame}\hlstd{(}\hlkwc{Run_Order}\hlstd{=NEG_Numbers,}\hlkwc{Number}\hlstd{=NEG_Cell_Lines,}\hlkwc{MDM2_status}\hlstd{=NEG_MDM2_Status,}\hlkwc{Treatment_Status}\hlstd{=NEG_Treatment_Status,} \hlkwc{Medium} \hlstd{= NEG_medium)}
\hlstd{NEG_sample_info}\hlkwb{<-}\hlkwd{rbind}\hlstd{(}\hlkwd{data.frame}\hlstd{(}\hlkwc{Run_Order}\hlstd{=}\hlnum{01}\hlstd{,}\hlkwc{Number}\hlstd{=}\hlstr{"BLANK 1"}\hlstd{,}\hlkwc{MDM2_status}\hlstd{=}\hlnum{NA}\hlstd{,}\hlkwc{Treatment_Status}\hlstd{=}\hlnum{NA}\hlstd{,}\hlkwc{Medium}\hlstd{=}\hlnum{NA}\hlstd{),NEG_sample_info)}

\hlstd{POS_Numbers}\hlkwb{<-}\hlkwd{c}\hlstd{()}
\hlkwa{for}\hlstd{(i} \hlkwa{in} \hlnum{1}\hlopt{:}\hlnum{82}\hlstd{)\{}
  \hlstd{POS_Numbers}\hlkwb{<-}\hlkwd{c}\hlstd{(POS_Numbers,}\hlkwd{strsplit}\hlstd{(}\hlkwd{strsplit}\hlstd{(}\hlkwd{as.character}\hlstd{(sample_IDs}\hlopt{$}\hlstd{POSITIVE[i]),}\hlstr{"_"}\hlstd{)[[}\hlnum{1}\hlstd{]][}\hlnum{2}\hlstd{],}\hlstr{"-"}\hlstd{)[[}\hlnum{1}\hlstd{]][}\hlnum{1}\hlstd{])}
\hlstd{\}}

\hlstd{POS_Cell_Lines}\hlkwb{<-}\hlkwd{c}\hlstd{()}
\hlkwa{for}\hlstd{(i} \hlkwa{in} \hlnum{1}\hlopt{:}\hlnum{82}\hlstd{)\{}
  \hlstd{POS_Cell_Lines}\hlkwb{<-}\hlkwd{c}\hlstd{(POS_Cell_Lines,}\hlkwd{strsplit}\hlstd{(}\hlkwd{as.character}\hlstd{(sample_IDs}\hlopt{$}\hlstd{POSITIVE[i]),}\hlstr{"-"}\hlstd{)[[}\hlnum{1}\hlstd{]][}\hlnum{2}\hlstd{])}
\hlstd{\}}

\hlstd{POS_MDM2_Status}\hlkwb{<-}\hlkwd{c}\hlstd{()}
\hlkwa{for}\hlstd{(i} \hlkwa{in} \hlstd{POS_Cell_Lines)\{}
  \hlstd{index}\hlkwb{<-}\hlkwd{match}\hlstd{(i,sample_info}\hlopt{$}\hlstd{Number)}
  \hlstd{POS_MDM2_Status}\hlkwb{<-}\hlkwd{c}\hlstd{(POS_MDM2_Status,}\hlkwd{as.character}\hlstd{(sample_info}\hlopt{$}\hlstd{CellLine[index]))}
\hlstd{\}}

\hlstd{POS_MDM2_Status}\hlkwb{<-}\hlkwd{sapply}\hlstd{(POS_MDM2_Status,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwa{if} \hlstd{(x} \hlopt{%in%} \hlstd{mdm2lo_groups)\{}\hlkwd{return}\hlstd{(}\hlstr{"Low"}\hlstd{)\}} \hlkwa{else if} \hlstd{(x} \hlopt{%in%} \hlstd{mdm2hi_groups)\{}\hlkwd{return}\hlstd{(}\hlstr{"High"}\hlstd{)\}} \hlkwa{else} \hlkwd{return}\hlstd{(}\hlnum{NA}\hlstd{))}

\hlstd{POS_Treatment_Status}\hlkwb{<-}\hlkwd{c}\hlstd{()}
\hlkwa{for}\hlstd{(i} \hlkwa{in} \hlstd{POS_Cell_Lines)\{}
  \hlstd{index}\hlkwb{<-}\hlkwd{match}\hlstd{(i,sample_info}\hlopt{$}\hlstd{Number)}
  \hlstd{POS_Treatment_Status}\hlkwb{<-}\hlkwd{c}\hlstd{(POS_Treatment_Status,}\hlkwd{as.character}\hlstd{(sample_info}\hlopt{$}\hlstd{Treatment[index]))}
\hlstd{\}}

\hlstd{POS_medium}\hlkwb{<-}\hlkwd{c}\hlstd{()}
\hlkwa{for}\hlstd{(i} \hlkwa{in} \hlstd{POS_Cell_Lines)\{}
  \hlstd{index}\hlkwb{<-}\hlkwd{match}\hlstd{(i,sample_info}\hlopt{$}\hlstd{Number)}
  \hlstd{POS_medium}\hlkwb{<-}\hlkwd{c}\hlstd{(POS_medium,}\hlkwd{as.character}\hlstd{(sample_info}\hlopt{$}\hlstd{Media[index]))}
\hlstd{\}}

\hlstd{POS_sample_info}\hlkwb{<-}\hlkwd{data.frame}\hlstd{(}\hlkwc{Run_Order}\hlstd{=POS_Numbers,}\hlkwc{Number}\hlstd{=POS_Cell_Lines,}\hlkwc{MDM2_status}\hlstd{=POS_MDM2_Status,}\hlkwc{Treatment_Status}\hlstd{=POS_Treatment_Status,} \hlkwc{Medium}\hlstd{=POS_medium)}

\hlstd{POS_sample_info}\hlkwb{<-}\hlstd{POS_sample_info[}\hlopt{-}\hlnum{52}\hlstd{,]}
\hlstd{POS_sample_info}\hlkwb{<-}\hlstd{POS_sample_info[}\hlopt{-}\hlnum{40}\hlstd{,]}

\hlcom{# Make lists of which samples go where and use intersections for easy plotting!}
\hlstd{MDM2Hi_samples}\hlkwb{<-}\hlkwd{as.vector}\hlstd{(POS_sample_info}\hlopt{$}\hlstd{Run_Order)[}\hlkwd{which}\hlstd{(POS_sample_info}\hlopt{$}\hlstd{MDM2_status}\hlopt{==}\hlstr{"High"}\hlstd{)]}
\hlstd{MDM2Lo_samples}\hlkwb{<-}\hlkwd{as.vector}\hlstd{(POS_sample_info}\hlopt{$}\hlstd{Run_Order)[}\hlkwd{which}\hlstd{(POS_sample_info}\hlopt{$}\hlstd{MDM2_status}\hlopt{==}\hlstr{"Low"}\hlstd{)]}

\hlstd{Treated_samples}\hlkwb{<-}\hlkwd{as.vector}\hlstd{(POS_sample_info}\hlopt{$}\hlstd{Run_Order)[}\hlkwd{which}\hlstd{(POS_sample_info}\hlopt{$}\hlstd{Treatment_Status}\hlopt{==}\hlstr{"Atorvastatin"}\hlstd{)]}
\hlstd{Untreated_samples}\hlkwb{<-}\hlkwd{as.vector}\hlstd{(POS_sample_info}\hlopt{$}\hlstd{Run_Order)[}\hlkwd{which}\hlstd{(POS_sample_info}\hlopt{$}\hlstd{Treatment_Status}\hlopt{==}\hlstr{"none"}\hlstd{)]}

\hlstd{STDP_samples}\hlkwb{<-}\hlkwd{as.vector}\hlstd{(POS_sample_info}\hlopt{$}\hlstd{Run_Order)[}\hlkwd{which}\hlstd{(POS_sample_info}\hlopt{$}\hlstd{Medium}\hlopt{==}\hlstr{"STDP"}\hlstd{)]}
\hlstd{DMEM_samples}\hlkwb{<-}\hlkwd{as.vector}\hlstd{(POS_sample_info}\hlopt{$}\hlstd{Run_Order)[}\hlkwd{which}\hlstd{(POS_sample_info}\hlopt{$}\hlstd{Medium}\hlopt{==}\hlstr{"DMEM"}\hlstd{)]}
\end{alltt}
\end{kframe}
\end{knitrout}

\subsection{Raw data}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{POS_data}\hlkwb{<-}\hlkwd{read.csv}\hlstd{(}\hlstr{"~/Desktop/Liposarcoma project/Lipidyzer/LipidMatch_output/MSDIAL_ID_Appended_POS_truncated.csv"}\hlstd{)}
\hlstd{NEG_data}\hlkwb{<-}\hlkwd{read.csv}\hlstd{(}\hlstr{"~/Desktop/Liposarcoma project/Lipidyzer/LipidMatch_output/MSDIAL_ID_Appended_NEG_truncated.csv"}\hlstd{)}

\hlkwd{colnames}\hlstd{(NEG_data)[}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)]}\hlkwb{<-}\hlkwd{sapply}\hlstd{(}\hlkwd{colnames}\hlstd{(NEG_data)[}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)],} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwd{return}\hlstd{(}\hlkwd{strsplit}\hlstd{(x,}\hlstr{"\textbackslash{}\textbackslash{}."}\hlstd{)[[}\hlnum{1}\hlstd{]][}\hlnum{2}\hlstd{]))}
\hlkwd{colnames}\hlstd{(POS_data)[}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)]}\hlkwb{<-}\hlkwd{sapply}\hlstd{(}\hlkwd{colnames}\hlstd{(POS_data)[}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)],} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwd{return}\hlstd{(}\hlkwd{strsplit}\hlstd{(x,}\hlstr{"\textbackslash{}\textbackslash{}."}\hlstd{)[[}\hlnum{1}\hlstd{]][}\hlnum{2}\hlstd{]))}

\hlkwd{colnames}\hlstd{(NEG_data)[}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)]}\hlkwb{<-}\hlkwd{paste0}\hlstd{(}\hlkwd{colnames}\hlstd{(NEG_data)[}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)],}\hlstr{" Peak area"}\hlstd{)}
\hlkwd{colnames}\hlstd{(POS_data)[}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)]}\hlkwb{<-}\hlkwd{paste0}\hlstd{(}\hlkwd{colnames}\hlstd{(POS_data)[}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)],}\hlstr{" Peak area"}\hlstd{)}

\hlcom{#colnames(NEG_data)[11:ncol(NEG_data)]<-gsub("LIPNEG17MAR_","",colnames(NEG_data)[11:ncol(NEG_data)])}
\hlcom{#colnames(POS_data)[11:ncol(POS_data)]<-gsub("LIPPOS17MAR_","",colnames(POS_data)[11:ncol(POS_data)])}

\hlcom{# Remove Blanks and Pools}
\hlstd{POS_data}\hlkwb{<-}\hlstd{POS_data[}\hlopt{!}\hlkwd{grepl}\hlstd{(}\hlstr{"POOL"}\hlstd{,}\hlkwd{colnames}\hlstd{(POS_data))]}
\hlstd{POS_data}\hlkwb{<-}\hlstd{POS_data[}\hlopt{!}\hlkwd{grepl}\hlstd{(}\hlstr{"BLANK"}\hlstd{,}\hlkwd{colnames}\hlstd{(POS_data))]}
\hlstd{NEG_data}\hlkwb{<-}\hlstd{NEG_data[}\hlopt{!}\hlkwd{grepl}\hlstd{(}\hlstr{"POOL"}\hlstd{,}\hlkwd{colnames}\hlstd{(NEG_data))]}
\hlstd{NEG_data}\hlkwb{<-}\hlstd{NEG_data[}\hlopt{!}\hlkwd{grepl}\hlstd{(}\hlstr{"BLANK"}\hlstd{,}\hlkwd{colnames}\hlstd{(NEG_data))]}

\hlkwd{par}\hlstd{(}\hlkwc{mfrow}\hlstd{=}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{2}\hlstd{))}
\hlkwd{boxplot}\hlstd{(POS_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)],}\hlkwc{main}\hlstd{=}\hlstr{"Raw Data, POS mode"}\hlstd{)}
\hlkwd{boxplot}\hlstd{(NEG_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)],}\hlkwc{main}\hlstd{=}\hlstr{"Raw Data, NEG mode"}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/RawData-1} 
\begin{kframe}\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{mfrow}\hlstd{=}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{1}\hlstd{))}
\end{alltt}
\end{kframe}
\end{knitrout}

\subsection{Normalize}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{## Normalize}
\hlstd{POS_median}\hlkwb{<-}\hlkwd{median}\hlstd{(}\hlkwd{apply}\hlstd{(POS_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)],}\hlnum{2}\hlstd{,sum))}
\hlstd{NEG_median}\hlkwb{<-}\hlkwd{median}\hlstd{(}\hlkwd{apply}\hlstd{(NEG_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)],}\hlnum{2}\hlstd{,sum))}

\hlstd{TICnormalize}\hlkwb{<-}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{,}\hlkwc{mode}\hlstd{) \{}
    \hlkwa{if}\hlstd{(mode}\hlopt{==}\hlstr{"POS"}\hlstd{)\{}
        \hlstd{TICmedian}\hlkwb{<-}\hlstd{POS_median}
    \hlstd{\}} \hlkwa{else if}\hlstd{(mode}\hlopt{==}\hlstr{"NEG"}\hlstd{)\{}
        \hlstd{TICmedian}\hlkwb{<-}\hlstd{NEG_median}
    \hlstd{\}}
    \hlstd{(x}\hlopt{/}\hlkwd{sum}\hlstd{(x))}\hlopt{*}\hlstd{TICmedian}
    \hlcom{#(x/sum(x))*median(x)}
\hlstd{\}}

\hlstd{factors}\hlkwb{<-}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{,}\hlkwc{mode}\hlstd{) \{}
    \hlkwa{if}\hlstd{(mode}\hlopt{==}\hlstr{"POS"}\hlstd{)\{}
        \hlstd{TICmedian}\hlkwb{<-}\hlstd{POS_median}
    \hlstd{\}} \hlkwa{else if}\hlstd{(mode}\hlopt{==}\hlstr{"NEG"}\hlstd{)\{}
        \hlstd{TICmedian}\hlkwb{<-}\hlstd{NEG_median}
    \hlstd{\}}
    \hlstd{(}\hlnum{1}\hlopt{/}\hlkwd{sum}\hlstd{(x))}\hlopt{*}\hlstd{TICmedian}
    \hlcom{#(x/sum(x))*median(x)}
\hlstd{\}}

\hlstd{POS_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)]}\hlkwb{<-}\hlkwd{apply}\hlstd{(POS_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)],}\hlnum{2}\hlstd{,TICnormalize,} \hlkwc{mode}\hlstd{=}\hlstr{"POS"}\hlstd{)}
\hlstd{NEG_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)]}\hlkwb{<-}\hlkwd{apply}\hlstd{(NEG_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)],}\hlnum{2}\hlstd{,TICnormalize,} \hlkwc{mode}\hlstd{=}\hlstr{"NEG"}\hlstd{)}

\hlkwd{par}\hlstd{(}\hlkwc{mfrow}\hlstd{=}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{2}\hlstd{))}
\hlkwd{boxplot}\hlstd{(POS_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)],}\hlkwc{main}\hlstd{=}\hlstr{"Normalized Data, POS mode"}\hlstd{)}
\hlkwd{boxplot}\hlstd{(NEG_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)],}\hlkwc{main}\hlstd{=}\hlstr{"Normalized Data, NEG mode"}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/Normalize-1} 
\begin{kframe}\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{mfrow}\hlstd{=}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{1}\hlstd{))}

\hlkwd{plot}\hlstd{(}\hlkwd{apply}\hlstd{(POS_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)],}\hlnum{2}\hlstd{,sum),}\hlkwc{main}\hlstd{=}\hlstr{"Sum intensity, POS mode"}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/Normalize-2} 

\end{knitrout}

\subsection{Log Transform}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{## Log transform}
\hlstd{POS_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)]}\hlkwb{<-}\hlstd{POS_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)]}\hlopt{+}\hlnum{0.001}
\hlstd{NEG_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)]}\hlkwb{<-}\hlstd{NEG_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)]}\hlopt{+}\hlnum{0.001}

\hlstd{POS_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)]}\hlkwb{<-}\hlkwd{log}\hlstd{(POS_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)],}\hlkwc{base}\hlstd{=}\hlnum{2}\hlstd{)}
\hlstd{NEG_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)]}\hlkwb{<-}\hlkwd{log}\hlstd{(NEG_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)],}\hlkwc{base}\hlstd{=}\hlnum{2}\hlstd{)}

\hlkwd{par}\hlstd{(}\hlkwc{mfrow}\hlstd{=}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{2}\hlstd{))}
\hlkwd{boxplot}\hlstd{(POS_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(POS_data)],}\hlkwc{main}\hlstd{=}\hlstr{"Log Transform/Normalized Data, POS mode"}\hlstd{)}
\hlkwd{boxplot}\hlstd{(NEG_data[,}\hlnum{11}\hlopt{:}\hlkwd{ncol}\hlstd{(NEG_data)],}\hlkwc{main}\hlstd{=}\hlstr{"Log Transform/Normalized Data, NEG mode"}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/LogTransform-1} 
\begin{kframe}\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{mfrow}\hlstd{=}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{1}\hlstd{))}
\end{alltt}
\end{kframe}
\end{knitrout}

\subsection{Merge Modes}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}
\includegraphics[width=\maxwidth]{figure/mergeAndDeduplicate-1} 

\end{knitrout}

\newpage
\blandscape

\section{Statistics}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'opts\_chunk' not found}}\end{kframe}
\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{groupMDM2Hi_Untreated_STDP}\hlkwb{<-}\hlkwd{intersect}\hlstd{(MDM2Hi_samples,}\hlkwd{intersect}\hlstd{(Untreated_samples,STDP_samples))}
\hlstd{groupMDM2Hi_Untreated_DMEM}\hlkwb{<-}\hlkwd{intersect}\hlstd{(MDM2Hi_samples,}\hlkwd{intersect}\hlstd{(Untreated_samples,DMEM_samples))}
\hlstd{groupMDM2Lo_Untreated_STDP}\hlkwb{<-}\hlkwd{intersect}\hlstd{(MDM2Lo_samples,}\hlkwd{intersect}\hlstd{(Untreated_samples,STDP_samples))}
\hlstd{groupMDM2Lo_Untreated_DMEM}\hlkwb{<-}\hlkwd{intersect}\hlstd{(MDM2Lo_samples,}\hlkwd{intersect}\hlstd{(Untreated_samples,DMEM_samples))}

\hlstd{groupMDM2Hi_Treated_STDP}\hlkwb{<-}\hlkwd{intersect}\hlstd{(MDM2Hi_samples,}\hlkwd{intersect}\hlstd{(Treated_samples,STDP_samples))}
\hlstd{groupMDM2Hi_Treated_DMEM}\hlkwb{<-}\hlkwd{intersect}\hlstd{(MDM2Hi_samples,}\hlkwd{intersect}\hlstd{(Treated_samples,DMEM_samples))}
\hlstd{groupMDM2Lo_Treated_STDP}\hlkwb{<-}\hlkwd{intersect}\hlstd{(MDM2Lo_samples,}\hlkwd{intersect}\hlstd{(Treated_samples,STDP_samples))}
\hlstd{groupMDM2Lo_Treated_DMEM}\hlkwb{<-}\hlkwd{intersect}\hlstd{(MDM2Lo_samples,}\hlkwd{intersect}\hlstd{(Treated_samples,DMEM_samples))}

\hlstd{lipidClassKey}\hlkwb{<-}\hlkwd{read.csv}\hlstd{(}\hlstr{"~/Desktop/Liposarcoma project/final_figures/lipidClassKey.csv"}\hlstd{)}

\hlstd{gg_color_hue} \hlkwb{<-} \hlkwa{function}\hlstd{(}\hlkwc{n}\hlstd{) \{}
    \hlstd{hues} \hlkwb{=} \hlkwd{seq}\hlstd{(}\hlnum{15}\hlstd{,} \hlnum{375}\hlstd{,} \hlkwc{length} \hlstd{= n} \hlopt{+} \hlnum{1}\hlstd{)}
    \hlkwd{hcl}\hlstd{(}\hlkwc{h} \hlstd{= hues,} \hlkwc{l} \hlstd{=} \hlnum{65}\hlstd{,} \hlkwc{c} \hlstd{=} \hlnum{100}\hlstd{)[}\hlnum{1}\hlopt{:}\hlstd{n]}
\hlstd{\}}

\hlstd{lipidClassKey}\hlopt{$}\hlstd{color}\hlkwb{<-}\hlkwd{gg_color_hue}\hlstd{(}\hlkwd{nrow}\hlstd{(lipidClassKey))}

\hlstd{mydiff} \hlkwb{<-} \hlkwa{function}\hlstd{(}\hlkwc{df}\hlstd{,}\hlkwc{gp1}\hlstd{,}\hlkwc{gp2}\hlstd{) \{}
    \hlstd{myp}\hlkwb{=}\hlkwd{as.numeric}\hlstd{(}\hlkwd{apply}\hlstd{(df,}\hlnum{1}\hlstd{,}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{}
          \hlstd{temp}\hlkwb{<-}\hlstd{x[}\hlopt{!}\hlkwd{is.na}\hlstd{(x)]}
              \hlstd{gp1}\hlkwb{<-}\hlkwd{setdiff}\hlstd{(gp1,}\hlkwd{colnames}\hlstd{(df)[}\hlkwd{is.na}\hlstd{(x)])}
              \hlstd{gp2}\hlkwb{<-}\hlkwd{setdiff}\hlstd{(gp2,}\hlkwd{colnames}\hlstd{(df)[}\hlkwd{is.na}\hlstd{(x)])}
              \hlkwa{if}\hlstd{(}\hlkwd{sd}\hlstd{(temp[}\hlkwd{c}\hlstd{(gp1,gp2)])}\hlopt{==}\hlnum{0}\hlstd{) \{}\hlnum{NA}\hlstd{\}}
              \hlkwa{if}\hlstd{(}\hlkwd{sd}\hlstd{(temp)}\hlopt{==}\hlnum{0}\hlstd{)\{}\hlnum{NA}\hlstd{\}}
                  \hlkwa{else} \hlstd{\{}
                      \hlstd{obj} \hlkwb{<-} \hlkwd{try}\hlstd{(}\hlkwd{t.test}\hlstd{(temp[gp1],temp[gp2]),} \hlkwc{silent}\hlstd{=}\hlnum{TRUE}\hlstd{)}
                              \hlkwa{if} \hlstd{(}\hlkwd{is}\hlstd{(obj,} \hlstr{"try-error"}\hlstd{))} \hlkwd{return}\hlstd{(}\hlnum{NA}\hlstd{)} \hlkwa{else} \hlkwd{return}\hlstd{(obj}\hlopt{$}\hlstd{p.value)}
                  \hlstd{\}}
      \hlstd{\}))}
      \hlstd{myp.adjust}\hlkwb{=}\hlkwd{p.adjust}\hlstd{(myp,}\hlkwc{method}\hlstd{=}\hlstr{'fdr'}\hlstd{)}
      \hlstd{log2fc}\hlkwb{=}\hlkwd{as.numeric}\hlstd{(}\hlkwd{apply}\hlstd{(df,}\hlnum{1}\hlstd{,}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{}
          \hlstd{temp}\hlkwb{<-}\hlstd{x[}\hlopt{!}\hlkwd{is.na}\hlstd{(x)]}
            \hlstd{gp1}\hlkwb{<-}\hlkwd{setdiff}\hlstd{(gp1,}\hlkwd{colnames}\hlstd{(df)[}\hlkwd{is.na}\hlstd{(x)])}
            \hlstd{gp2}\hlkwb{<-}\hlkwd{setdiff}\hlstd{(gp2,}\hlkwd{colnames}\hlstd{(df)[}\hlkwd{is.na}\hlstd{(x)])}
            \hlkwd{mean}\hlstd{(temp[gp1])}\hlopt{-}\hlkwd{mean}\hlstd{(temp[gp2])}
      \hlstd{\}}
      \hlstd{))}
      \hlkwd{return}\hlstd{(}\hlkwd{data.frame}\hlstd{(}\hlkwc{name}\hlstd{=}\hlkwd{rownames}\hlstd{(df),}\hlkwc{myp}\hlstd{=myp,}\hlkwc{mypadj}\hlstd{=myp.adjust,}\hlkwc{log2fc}\hlstd{=log2fc))}
\hlstd{\}}

\hlstd{filterMyDiff}\hlkwb{<-}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}
    \hlstd{keepers}\hlkwb{=}\hlkwd{intersect}\hlstd{(}\hlkwd{which}\hlstd{(x}\hlopt{$}\hlstd{mypadj}\hlopt{<}\hlnum{0.05}\hlstd{),}\hlkwd{c}\hlstd{(}\hlkwd{which}\hlstd{(x}\hlopt{$}\hlstd{log2fc}\hlopt{>}\hlnum{1}\hlstd{),}\hlkwd{which}\hlstd{(x}\hlopt{$}\hlstd{log2fc}\hlopt{< -}\hlnum{1}\hlstd{)))}
    \hlkwd{return}\hlstd{(x[keepers,])}
\hlstd{\}}
\hlkwd{library}\hlstd{(readxl)}
\hlstd{lipidomic_key}\hlkwb{<-}\hlkwd{read_xlsx}\hlstd{(}\hlstr{"~/Desktop/Liposarcoma project/Lipidomics_key.xlsx"}\hlstd{,}\hlkwc{sheet}\hlstd{=}\hlnum{1}\hlstd{)}
\hlkwd{library}\hlstd{(RColorBrewer)}

\hlstd{volcano_plotter} \hlkwb{<-} \hlkwa{function}\hlstd{(}\hlkwc{df}\hlstd{,}\hlkwc{gp1}\hlstd{,}\hlkwc{gp2}\hlstd{,}\hlkwc{title}\hlstd{)\{}
    \hlstd{T_test_results}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(df,gp1,gp2)}
      \hlcom{# Make insignificant points smaller and more transparent}
    \hlstd{T_test_results}\hlopt{$}\hlstd{significant} \hlkwb{=} \hlkwd{abs}\hlstd{(T_test_results}\hlopt{$}\hlstd{log2fc)} \hlopt{>} \hlnum{1} \hlopt{& -}\hlkwd{log10}\hlstd{(T_test_results}\hlopt{$}\hlstd{mypadj)} \hlopt{> -}\hlkwd{log10}\hlstd{(}\hlnum{0.05}\hlstd{)}
       \hlcom{#T_test_results$alpha <- ifelse(T_test_results$significant,0.05,0.025)}
    \hlstd{T_test_results}\hlopt{$}\hlstd{size} \hlkwb{<-} \hlkwd{ifelse}\hlstd{(T_test_results}\hlopt{$}\hlstd{significant,}\hlnum{4}\hlstd{,}\hlnum{2}\hlstd{)}

      \hlcom{# Color code by lipid class}
    \hlstd{T_test_results}\hlopt{$}\hlstd{MainClass}\hlkwb{<-}\hlstd{lipidomic_key}\hlopt{$}\hlstd{`LM Main Class`[}\hlkwd{match}\hlstd{(T_test_results}\hlopt{$}\hlstd{name,lipidomic_key}\hlopt{$}\hlstd{name)]}
    \hlstd{palette_names}\hlkwb{<-}\hlkwd{sort}\hlstd{(}\hlkwd{unique}\hlstd{(T_test_results}\hlopt{$}\hlstd{MainClass))}
    \hlcom{#T_test_results$MainClass<-sapply(1:nrow(T_test_results),function(x)\{}
    \hlstd{T_test_results}\hlopt{$}\hlstd{MainClass}\hlkwb{<-}\hlkwd{sapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlkwd{nrow}\hlstd{(T_test_results),}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}
        \hlkwd{ifelse}\hlstd{(T_test_results}\hlopt{$}\hlstd{significant[x],}
           \hlkwd{return}\hlstd{(T_test_results}\hlopt{$}\hlstd{MainClass[x]),}\hlkwd{return}\hlstd{(}\hlstr{"Not Significant"}\hlstd{))}
    \hlstd{\})}

    \hlstd{legend_labels}\hlkwb{<-}\hlkwd{sort}\hlstd{(}\hlkwd{unique}\hlstd{(}\hlkwd{sapply}\hlstd{(T_test_results}\hlopt{$}\hlstd{MainClass,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}
        \hlkwa{if}\hlstd{(}\hlopt{!}\hlkwd{is.na}\hlstd{(x))\{}
            \hlkwd{return}\hlstd{(}\hlkwd{paste0}\hlstd{(x,}\hlstr{" (n="}\hlstd{,}\hlkwd{length}\hlstd{(}\hlkwd{which}\hlstd{(T_test_results}\hlopt{$}\hlstd{MainClass}\hlopt{==}\hlstd{x)),}\hlstr{")"}\hlstd{))}
        \hlstd{\}}\hlkwa{else}\hlstd{\{}
            \hlkwd{return}\hlstd{(x)}
        \hlstd{\}}
    \hlstd{\})))}

    \hlcom{#legend_labels<-legend_labels[-which(is.na(legend_labels))]}

    \hlstd{palette}\hlkwb{<-}\hlkwd{c}\hlstd{(}\hlkwd{brewer.pal}\hlstd{(}\hlnum{12}\hlstd{,}\hlstr{"Paired"}\hlstd{),}\hlstr{"#40E0D0"}\hlstd{,}\hlstr{"violet"}\hlstd{,}\hlstr{"grey80"}\hlstd{)}
      \hlcom{#palette <- c("#FF7F00","#4DAF4A","#377EB8","#E41A1C")}
    \hlkwd{names}\hlstd{(palette)}\hlkwb{<-}\hlkwd{c}\hlstd{(palette_names,}\hlstr{"Not Significant"}\hlstd{)}
    \hlstd{palette}\hlkwb{<-}\hlstd{palette[}\hlkwd{unique}\hlstd{(T_test_results}\hlopt{$}\hlstd{MainClass)]}
    \hlcom{#palette<-palette[-which(is.na(palette))]}

    \hlkwa{if}\hlstd{(}\hlkwd{any}\hlstd{(T_test_results}\hlopt{$}\hlstd{significant))\{}
        \hlstd{g} \hlkwb{=} \hlkwd{ggplot}\hlstd{(}\hlkwc{data}\hlstd{=T_test_results,} \hlkwd{aes}\hlstd{(}\hlkwc{x}\hlstd{=log2fc,} \hlkwc{y}\hlstd{=}\hlopt{-}\hlkwd{log10}\hlstd{(mypadj),} \hlkwc{colour}\hlstd{=MainClass))} \hlopt{+}
            \hlkwd{geom_point}\hlstd{(}\hlkwc{alpha}\hlstd{=}\hlnum{0.7}\hlstd{,}\hlkwd{aes}\hlstd{(}\hlkwc{size}\hlstd{=size,} \hlkwc{text}\hlstd{=name))} \hlopt{+}
            \hlkwd{scale_color_manual}\hlstd{(}\hlkwc{values} \hlstd{= palette,}
                               \hlcom{#na.value="grey80",}
                               \hlkwc{labels}\hlstd{=legend_labels,}
                               \hlkwc{name}\hlstd{=}\hlstr{"LipidMaps Main Class"}\hlstd{)} \hlopt{+}
            \hlkwd{theme_bw}\hlstd{()} \hlopt{+}
            \hlcom{#scale_color_brewer(palette="Paired",na.value="grey80") +}
            \hlkwd{ggtitle}\hlstd{(title)} \hlopt{+}
            \hlkwd{theme}\hlstd{(}\hlkwc{plot.title} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{hjust} \hlstd{=} \hlnum{0.5}\hlstd{))} \hlopt{+}
            \hlkwd{theme}\hlstd{(}\hlkwc{panel.grid.major} \hlstd{=} \hlkwd{element_blank}\hlstd{(),} \hlkwc{panel.grid.minor} \hlstd{=} \hlkwd{element_blank}\hlstd{())} \hlopt{+}
            \hlkwd{ylab}\hlstd{(}\hlstr{"-log10 p-value"}\hlstd{)} \hlopt{+}
            \hlkwd{geom_hline}\hlstd{(}\hlkwc{yintercept} \hlstd{=} \hlopt{-}\hlkwd{log10}\hlstd{(}\hlnum{0.05}\hlstd{),}\hlkwc{lty} \hlstd{=} \hlnum{2}\hlstd{)} \hlopt{+}
            \hlkwd{geom_vline}\hlstd{(}\hlkwc{xintercept} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{lty} \hlstd{=} \hlnum{2}\hlstd{)} \hlopt{+}
            \hlkwd{geom_vline}\hlstd{(}\hlkwc{xintercept} \hlstd{=} \hlopt{-}\hlnum{1}\hlstd{,} \hlkwc{lty} \hlstd{=} \hlnum{2}\hlstd{)} \hlopt{+}
            \hlkwd{scale_size}\hlstd{(}\hlkwc{range}\hlstd{=}\hlkwd{c}\hlstd{(}\hlnum{2}\hlstd{,}\hlnum{4}\hlstd{))} \hlopt{+}
            \hlkwd{guides}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{FALSE}\hlstd{)}
    \hlstd{\}}\hlkwa{else}\hlstd{\{}
        \hlstd{g} \hlkwb{=} \hlkwd{ggplot}\hlstd{(}\hlkwc{data}\hlstd{=T_test_results,} \hlkwd{aes}\hlstd{(}\hlkwc{x}\hlstd{=log2fc,} \hlkwc{y}\hlstd{=}\hlopt{-}\hlkwd{log10}\hlstd{(mypadj)))} \hlopt{+}
            \hlkwd{geom_point}\hlstd{(}\hlkwc{alpha}\hlstd{=}\hlnum{0.4}\hlstd{,}\hlkwd{aes}\hlstd{(}\hlkwc{text}\hlstd{=name))} \hlopt{+}
            \hlkwd{scale_color_manual}\hlstd{(}\hlkwc{values} \hlstd{= palette)} \hlopt{+}\hlcom{#,na.value="grey80") +}
            \hlkwd{theme_bw}\hlstd{()} \hlopt{+}
            \hlcom{#scale_color_brewer(palette="Paired",na.value="grey80") +}
            \hlkwd{ggtitle}\hlstd{(title)} \hlopt{+}
            \hlkwd{theme}\hlstd{(}\hlkwc{plot.title} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{hjust} \hlstd{=} \hlnum{0.5}\hlstd{))} \hlopt{+}
            \hlkwd{theme}\hlstd{(}\hlkwc{panel.grid.major} \hlstd{=} \hlkwd{element_blank}\hlstd{(),} \hlkwc{panel.grid.minor} \hlstd{=} \hlkwd{element_blank}\hlstd{())} \hlopt{+}
            \hlkwd{ylab}\hlstd{(}\hlstr{"-log10 p-value"}\hlstd{)} \hlopt{+}
            \hlkwd{geom_hline}\hlstd{(}\hlkwc{yintercept} \hlstd{=} \hlopt{-}\hlkwd{log10}\hlstd{(}\hlnum{0.05}\hlstd{),}\hlkwc{lty} \hlstd{=} \hlnum{2}\hlstd{)} \hlopt{+}
            \hlkwd{geom_vline}\hlstd{(}\hlkwc{xintercept} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{lty} \hlstd{=} \hlnum{2}\hlstd{)} \hlopt{+}
            \hlkwd{geom_vline}\hlstd{(}\hlkwc{xintercept} \hlstd{=} \hlopt{-}\hlnum{1}\hlstd{,} \hlkwc{lty} \hlstd{=} \hlnum{2}\hlstd{)}
            \hlkwd{return}\hlstd{(g)}
    \hlstd{\}}

      \hlstd{T_test_results_sig}\hlkwb{<-}\hlstd{T_test_results[T_test_results}\hlopt{$}\hlstd{significant,]}
      \hlstd{text_size}\hlkwb{<-}\hlkwd{round}\hlstd{(}\hlkwd{min}\hlstd{(}\hlnum{20}\hlstd{,}\hlnum{350}\hlopt{/}\hlkwd{nrow}\hlstd{(T_test_results_sig)),}\hlkwc{digits}\hlstd{=}\hlnum{0}\hlstd{)}
      \hlcom{#bpPalette<-as.vector(palette[sort(unique(T_test_results_sig$superClass))])}
      \hlstd{barplot}\hlkwb{<-}\hlkwd{ggplot}\hlstd{(T_test_results_sig,} \hlkwd{aes}\hlstd{(}\hlkwc{x}\hlstd{=}\hlkwd{reorder}\hlstd{(name,log2fc),} \hlkwc{y}\hlstd{=log2fc ))}\hlopt{+}
          \hlkwd{theme_bw}\hlstd{()} \hlopt{+}
          \hlkwd{geom_bar}\hlstd{(}\hlkwc{stat}\hlstd{=}\hlstr{"identity"}\hlstd{,}\hlkwc{colour}\hlstd{=}\hlstr{"black"}\hlstd{,}\hlkwd{aes}\hlstd{(}\hlkwc{fill} \hlstd{= MainClass))} \hlopt{+}
          \hlkwd{scale_fill_manual}\hlstd{(}\hlkwc{values} \hlstd{= palette)} \hlopt{+}
          \hlkwd{coord_flip}\hlstd{()} \hlopt{+}
         \hlcom{#ylab("log2(mean(MDM2hi)-mean(MDM2lo))") +}
          \hlkwd{ylab}\hlstd{(}\hlstr{"log2fc"}\hlstd{)} \hlopt{+}
          \hlkwd{theme}\hlstd{(}\hlkwc{axis.title.y} \hlstd{=} \hlkwd{element_blank}\hlstd{(),}\hlkwc{axis.title.x} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{12}\hlstd{,}\hlkwc{face}\hlstd{=}\hlstr{"bold"}\hlstd{),}\hlkwc{axis.text.y}\hlstd{=}\hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=text_size),}\hlkwc{axis.text.x}\hlstd{=}\hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{10}\hlstd{))} \hlopt{+}
          \hlkwd{theme}\hlstd{(}\hlkwc{panel.grid.major} \hlstd{=} \hlkwd{element_blank}\hlstd{(),} \hlkwc{panel.grid.minor} \hlstd{=} \hlkwd{element_blank}\hlstd{())}

      \hlkwd{return}\hlstd{(}\hlkwd{list}\hlstd{(g,barplot))}
\hlstd{\}}

\hlkwd{save}\hlstd{(LM_area, groupMDM2Hi_Treated_DMEM, groupMDM2Lo_Treated_DMEM,}
     \hlstd{groupMDM2Hi_Treated_STDP, groupMDM2Lo_Treated_STDP,}
     \hlstd{groupMDM2Hi_Untreated_DMEM,groupMDM2Lo_Untreated_DMEM,}
     \hlstd{groupMDM2Hi_Untreated_STDP,groupMDM2Lo_Untreated_STDP,}
     \hlkwc{file}\hlstd{=}\hlstr{"~/Desktop/Liposarcoma project/final_figures/final_figures_org_file/figure3.Rda"}\hlstd{)}
\end{alltt}
\end{kframe}
\end{knitrout}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{plot_list}\hlkwb{<-}\hlkwd{list}\hlstd{(}
    \hlkwd{volcano_plotter}\hlstd{(LM_area,}
                    \hlstd{groupMDM2Hi_Untreated_DMEM,}
                    \hlstd{groupMDM2Lo_Untreated_DMEM,}
                    \hlstr{"MDM2 High vs Low, Untreated, DMEM"}\hlstd{)[[}\hlnum{1}\hlstd{]]}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(MDM2Hi))-log2(mean(MDM2Lo))"}\hlstd{),}
    \hlkwd{volcano_plotter}\hlstd{(LM_area,}
                    \hlstd{groupMDM2Hi_Untreated_STDP,}
                    \hlstd{groupMDM2Lo_Untreated_STDP,}
                    \hlstr{"MDM2Hi vs MDM2lo, Untreated, STDP"}\hlstd{)[[}\hlnum{1}\hlstd{]]}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(MDM2Hi))-log2(mean(MDM2Lo))"}\hlstd{),}
    \hlkwd{volcano_plotter}\hlstd{(LM_area,}
                    \hlstd{groupMDM2Hi_Treated_DMEM,}
                    \hlstd{groupMDM2Lo_Treated_DMEM,}
                    \hlstr{"MDM2Hi vs MDM2lo, Treated, DMEM"}\hlstd{)[[}\hlnum{1}\hlstd{]]}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(MDM2Hi))-log2(mean(MDM2Lo))"}\hlstd{),}
    \hlkwd{volcano_plotter}\hlstd{(LM_area,}
                    \hlstd{groupMDM2Hi_Treated_STDP,}
                    \hlstd{groupMDM2Lo_Treated_STDP,}
                    \hlstr{"MDM2Hi vs MDM2lo, Treated, STDP"}\hlstd{)[[}\hlnum{1}\hlstd{]]}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(MDM2Hi))-log2(mean(MDM2Lo))"}\hlstd{),}
    \hlkwd{volcano_plotter}\hlstd{(LM_area,}
                    \hlstd{groupMDM2Hi_Treated_DMEM,}
                    \hlstd{groupMDM2Hi_Untreated_DMEM,}
                    \hlstr{"Treated vs Untreated, MDM2Hi, DMEM"}\hlstd{)}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(Treated))-log2(mean(Untreated))"}\hlstd{),}
    \hlkwd{volcano_plotter}\hlstd{(LM_area,}
                    \hlstd{groupMDM2Lo_Treated_DMEM,}
                    \hlstd{groupMDM2Lo_Untreated_DMEM,}
                    \hlstr{"Treated vs Untreated, MDM2Lo, DMEM"}\hlstd{)[[}\hlnum{1}\hlstd{]]}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(Treated))-log2(mean(Untreated))"}\hlstd{),}
    \hlkwd{volcano_plotter}\hlstd{(LM_area,}
                    \hlstd{groupMDM2Hi_Treated_STDP,}
                    \hlstd{groupMDM2Hi_Untreated_STDP,}
                    \hlstr{"Treated vs Untreated, MDM2Hi, STDP"}\hlstd{)}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(Treated))-log2(mean(Untreated))"}\hlstd{),}
    \hlkwd{volcano_plotter}\hlstd{(LM_area,}
                    \hlstd{groupMDM2Lo_Treated_STDP,}
                    \hlstd{groupMDM2Lo_Untreated_STDP,}
                    \hlstr{"Treated vs Untreated, MDM2Lo, STDP"}\hlstd{)[[}\hlnum{1}\hlstd{]]}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(Treated))-log2(mean(Untreated))"}\hlstd{),}
    \hlkwd{volcano_plotter}\hlstd{(LM_area,}
                    \hlstd{groupMDM2Hi_Untreated_STDP,}
                    \hlstd{groupMDM2Hi_Untreated_DMEM,}
                    \hlstr{"STDP vs DMEM, MDM2Hi, Untreated"}\hlstd{)[[}\hlnum{1}\hlstd{]]}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(STDP))-log2(mean(DMEM))"}\hlstd{),}
    \hlkwd{volcano_plotter}\hlstd{(LM_area,}
                    \hlstd{groupMDM2Lo_Untreated_STDP,}
                    \hlstd{groupMDM2Lo_Untreated_DMEM,}
                    \hlstr{"STDP vs DMEM, MDM2Lo, Untreated"}\hlstd{)[[}\hlnum{1}\hlstd{]]}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(STDP))-log2(mean(DMEM))"}\hlstd{),}
    \hlkwd{volcano_plotter}\hlstd{(LM_area,}
                    \hlstd{groupMDM2Hi_Treated_STDP,}
                    \hlstd{groupMDM2Hi_Treated_DMEM,}
                    \hlstr{"STDP vs DMEM, MDM2Hi, Treated"}\hlstd{)[[}\hlnum{1}\hlstd{]]}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(STDP))-log2(mean(DMEM))"}\hlstd{),}
    \hlkwd{volcano_plotter}\hlstd{(LM_area,}
                    \hlstd{groupMDM2Lo_Treated_STDP,}
                    \hlstd{groupMDM2Lo_Treated_DMEM,}
                    \hlstr{"STDP vs DMEM, MDM2Lo, Treated"}\hlstd{)[[}\hlnum{1}\hlstd{]]}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(STDP))-log2(mean(DMEM))"}\hlstd{)}
\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\begin{alltt}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=plot_list[}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{3}\hlstd{,}\hlnum{2}\hlstd{,}\hlnum{4}\hlstd{)],}\hlkwc{cols}\hlstd{=}\hlnum{2}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/volcanoPlots-1} 
\begin{kframe}\begin{alltt}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=plot_list[}\hlkwd{c}\hlstd{(}\hlnum{6}\hlstd{,}\hlnum{5}\hlstd{,}\hlnum{8}\hlstd{,}\hlnum{7}\hlstd{)],}\hlkwc{cols}\hlstd{=}\hlnum{2}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/volcanoPlots-2} 
\begin{kframe}\begin{alltt}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=plot_list[}\hlkwd{c}\hlstd{(}\hlnum{10}\hlstd{,}\hlnum{9}\hlstd{,}\hlnum{12}\hlstd{,}\hlnum{11}\hlstd{)],}\hlkwc{cols}\hlstd{=}\hlnum{2}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/volcanoPlots-3} 

\end{knitrout}

\elandscape
\newpage

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'opts\_chunk' not found}}\end{kframe}
\end{knitrout}
\section{Detailed Volcano Plots}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{###########################}
\hlcom{# Hi vs Lo, Untreated DMEM}
\hlcom{###########################}

\hlstd{summary}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,}
\hlstd{groupMDM2Hi_Untreated_DMEM,}
\hlstd{groupMDM2Lo_Untreated_DMEM)}

\hlcom{# Color code by lipid class}
\hlstd{lipid_list}\hlkwb{<-}\hlstd{summary}\hlopt{$}\hlstd{name}
\hlstd{lipid_classes}\hlkwb{<-}\hlkwd{sapply}\hlstd{(lipid_list,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwd{gsub}\hlstd{(}\hlstr{"\textbackslash{}\textbackslash{}s*\textbackslash{}\textbackslash{}([^\textbackslash{}\textbackslash{})]+\textbackslash{}\textbackslash{})"}\hlstd{,}\hlstr{""}\hlstd{,}\hlkwd{as.character}\hlstd{(x)))}
\hlstd{lipid_classes}\hlkwb{<-}\hlkwd{sapply}\hlstd{(lipid_classes,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwd{gsub}\hlstd{(}\hlstr{")"}\hlstd{,}\hlstr{""}\hlstd{,}\hlkwd{as.character}\hlstd{(x)))}
\hlstd{lipid_classes}\hlkwb{<-}\hlkwd{sapply}\hlstd{(lipid_classes,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwd{gsub}\hlstd{(}\hlstr{"_16:1"}\hlstd{,}\hlstr{""}\hlstd{,}\hlkwd{as.character}\hlstd{(x)))}
\hlstd{summary}\hlopt{$}\hlstd{superClass}\hlkwb{<-}\hlstd{lipidClassKey}\hlopt{$}\hlstd{Class[}\hlkwd{match}\hlstd{(lipid_classes,lipidClassKey}\hlopt{$}\hlstd{Abbreviation)]}
\hlcom{#lipid_classes<-as.vector(lipidClassKey$Subclass[match(lipid_classes,lipidClassKey$Abbreviation)])}
\hlstd{lipid_classes}\hlkwb{<-}\hlkwd{sapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlkwd{nrow}\hlstd{(summary),}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}
    \hlkwd{ifelse}\hlstd{(summary}\hlopt{$}\hlstd{significant[x],}\hlkwd{return}\hlstd{(lipid_classes[x]),}\hlkwd{return}\hlstd{(}\hlnum{NA}\hlstd{))}
\hlstd{\})}
\hlcom{#summary$class<-as.factor(lipid_classes)}

\hlstd{summary}\hlopt{$}\hlstd{significant} \hlkwb{=} \hlkwd{abs}\hlstd{(summary}\hlopt{$}\hlstd{log2fc)} \hlopt{>} \hlnum{1} \hlopt{& -}\hlkwd{log10}\hlstd{(summary}\hlopt{$}\hlstd{mypadj)} \hlopt{> -}\hlkwd{log10}\hlstd{(}\hlnum{0.05}\hlstd{)}
\hlkwd{library}\hlstd{(dplyr)}
\end{alltt}


{\ttfamily\noindent\itshape\color{messagecolor}{\#\# \\\#\# Attaching package: 'dplyr'}}

{\ttfamily\noindent\itshape\color{messagecolor}{\#\# The following object is masked from 'package:reshape':\\\#\# \\\#\#\ \ \ \  rename}}

{\ttfamily\noindent\itshape\color{messagecolor}{\#\# The following objects are masked from 'package:stats':\\\#\# \\\#\#\ \ \ \  filter, lag}}

{\ttfamily\noindent\itshape\color{messagecolor}{\#\# The following objects are masked from 'package:base':\\\#\# \\\#\#\ \ \ \  intersect, setdiff, setequal, union}}\begin{alltt}
\hlkwd{library}\hlstd{(tibble)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: package 'tibble' was built under R version 3.5.2}}\begin{alltt}
\hlstd{summary}\hlkwb{<-}\hlkwd{as.tibble}\hlstd{(summary)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: `as.tibble()` is deprecated, use `as\_tibble()` (but mind the new semantics).\\\#\# This warning is displayed once per session.}}\begin{alltt}
\hlcom{#summary<-select(summary,significant,superClass)}
\hlcom{#save(summary,file="LipidMDM2HiLoSummary.Rdata")}

\hlcom{#pdf("~/Desktop/lipidsHiLo.pdf")}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=}\hlkwd{volcano_plotter}\hlstd{(LM_area,}
\hlstd{groupMDM2Hi_Untreated_DMEM,}
\hlstd{groupMDM2Lo_Untreated_DMEM,}
\hlstr{"MDM2 High vs Low, DMEM, Untreated"}\hlstd{),}\hlkwc{cols}\hlstd{=}\hlnum{1}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\end{kframe}
\includegraphics[width=\maxwidth]{figure/detailVPs-1} 
\begin{kframe}\begin{alltt}
\hlcom{#dev.off()}

\hlkwd{pdf}\hlstd{(}\hlstr{"~/Desktop/lipidsHiLo.pdf"}\hlstd{)}
\hlkwd{volcano_plotter}\hlstd{(LM_area,}
\hlstd{groupMDM2Hi_Untreated_DMEM,}
\hlstd{groupMDM2Lo_Untreated_DMEM,}
\hlstr{"MDM2 High vs Low, DMEM, Untreated"}\hlstd{)[[}\hlnum{2}\hlstd{]]} \hlopt{+} \hlkwd{ylab}\hlstd{(}\hlstr{"log2(mean(MDM2 High))-log2(mean(MDM2 Low))"}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\begin{alltt}
\hlkwd{dev.off}\hlstd{()}
\end{alltt}
\begin{verbatim}
## pdf 
##   2
\end{verbatim}
\end{kframe}
\end{knitrout}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{HIvsLO_untreated_DMEM}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,groupMDM2Hi_Untreated_DMEM,groupMDM2Lo_Untreated_DMEM)}
\hlstd{significant_HIvsLO_untreated_DMEM}\hlkwb{<-}\hlkwd{filterMyDiff}\hlstd{(HIvsLO_untreated_DMEM)}
\hlstd{insignificant_HivsLo_untreated_DMEM}\hlkwb{<-}\hlstd{HIvsLO_untreated_DMEM[}\hlkwd{union}\hlstd{(}\hlkwd{which}\hlstd{(HIvsLO_untreated_DMEM}\hlopt{$}\hlstd{mypadj}\hlopt{>}\hlnum{0.05}\hlstd{),}\hlkwd{intersect}\hlstd{(}\hlkwd{which}\hlstd{(HIvsLO_untreated_DMEM}\hlopt{$}\hlstd{log2fc}\hlopt{<}\hlnum{1}\hlstd{),}\hlkwd{which}\hlstd{(HIvsLO_untreated_DMEM}\hlopt{$}\hlstd{log2fc}\hlopt{> -}\hlnum{1}\hlstd{))),]}
\hlcom{#write.csv(insignificant_HivsLo_untreated_DMEM,"~/Desktop/Liposarcoma project/Lipidomics_tests_11_1/HIvsLO_untreated_DMEM_insignificant.csv")}
\hlcom{#write.csv(significant_HIvsLO_untreated_DMEM,"~/Desktop/Liposarcoma project/Lipidomics_tests_11_1/HIvsLO_untreated_DMEM.csv")}

\hlcom{###########################}
\hlcom{# Treated vs Untreated, MDM2Hi, DMEM}
\hlcom{###########################}
\hlcom{#png("~/Desktop/Liposarcoma project/final_figures/highQualityPNGs/LipidMDM2HiTreatedvsUntreated.png",width=6,height=4,units="in",res=300)}

\hlkwd{volcano_plotter}\hlstd{(LM_area,}
                \hlstd{groupMDM2Hi_Treated_DMEM,}
                \hlstd{groupMDM2Hi_Untreated_DMEM,}
                \hlstr{"MDM2Hi, Treated vs Untreated"}\hlstd{)}\hlopt{+}\hlkwd{xlab}\hlstd{(}\hlstr{"log2(mean(Treated))-log2(mean(Untreated))"}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\end{kframe}
\includegraphics[width=\maxwidth]{figure/restOfTheDoc-1} 
\begin{kframe}\begin{alltt}
\hlcom{#dev.off()}

\hlstd{TreVsUnt_Hi_DMEM}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,}
                \hlstd{groupMDM2Hi_Treated_DMEM,}
                \hlstd{groupMDM2Hi_Untreated_DMEM)}
\hlstd{significant_TreVsUnt_Hi_DMEM}\hlkwb{<-}\hlkwd{filterMyDiff}\hlstd{(TreVsUnt_Hi_DMEM)}

\hlcom{###########################}
\hlcom{# Treated vs Untreated, MDM2Lo, DMEM}
\hlcom{###########################}
\hlcom{#png("~/Desktop/Liposarcoma project/final_figures/highQualityPNGs/LipidMDM2LoTreatedvsUntreated.png",width=6,height=4,units="in",res=300)}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=}\hlkwd{volcano_plotter}\hlstd{(LM_area,}
                \hlstd{groupMDM2Lo_Treated_DMEM,}
                \hlstd{groupMDM2Lo_Untreated_DMEM,}
                \hlstr{"MDM2Lo, Treated vs Untreated"}\hlstd{),}\hlkwc{cols}\hlstd{=}\hlnum{1}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\end{kframe}
\includegraphics[width=\maxwidth]{figure/restOfTheDoc-2} 
\begin{kframe}\begin{alltt}
\hlcom{#dev.off()}

\hlstd{TreVsUnt_Lo_DMEM}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,}
                \hlstd{groupMDM2Lo_Treated_DMEM,}
                \hlstd{groupMDM2Lo_Untreated_DMEM)}
\hlstd{significant_TreVsUnt_Lo_DMEM}\hlkwb{<-}\hlkwd{filterMyDiff}\hlstd{(TreVsUnt_Lo_DMEM)}


\hlcom{###########################}
\hlcom{# Hi vs Lo, Untreated STDP}
\hlcom{###########################}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=}\hlkwd{volcano_plotter}\hlstd{(LM_area,}
\hlstd{groupMDM2Hi_Untreated_STDP,}
\hlstd{groupMDM2Lo_Untreated_STDP,}
\hlstr{"MDM2Hi vs MDM2lo, Untreated, STDP"}\hlstd{),}\hlkwc{cols}\hlstd{=}\hlnum{1}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\end{kframe}
\includegraphics[width=\maxwidth]{figure/restOfTheDoc-3} 
\begin{kframe}\begin{alltt}
\hlstd{HIvsLO_untreated_STDP}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,groupMDM2Hi_Untreated_STDP,groupMDM2Lo_Untreated_STDP)}
\hlstd{significant_HIvsLO_untreated_STDP}\hlkwb{<-}\hlkwd{filterMyDiff}\hlstd{(HIvsLO_untreated_STDP)}

\hlcom{###########################}
\hlcom{# Hi vs Lo, Treated DMEM}
\hlcom{###########################}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=}\hlkwd{volcano_plotter}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Hi_Treated_DMEM,}
                                \hlstd{groupMDM2Lo_Treated_DMEM,}
                                \hlstr{"MDM2Hi vs MDM2lo, Treated, DMEM"}\hlstd{),}\hlkwc{cols}\hlstd{=}\hlnum{1}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\end{kframe}
\includegraphics[width=\maxwidth]{figure/restOfTheDoc-4} 
\begin{kframe}\begin{alltt}
\hlstd{HIvsLO_treated_DMEM}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,groupMDM2Hi_Treated_DMEM,groupMDM2Lo_Treated_DMEM)}
\hlstd{significant_HIvsLO_treated_DMEM}\hlkwb{<-}\hlkwd{filterMyDiff}\hlstd{(HIvsLO_treated_DMEM)}

\hlcom{###########################}
\hlcom{# Hi vs Lo, Treated STDP}
\hlcom{###########################}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=}\hlkwd{volcano_plotter}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Hi_Treated_STDP,}
                                \hlstd{groupMDM2Lo_Treated_STDP,}
                                \hlstr{"MDM2Hi vs MDM2lo, Treated, STDP"}\hlstd{),}\hlkwc{cols}\hlstd{=}\hlnum{1}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\end{kframe}
\includegraphics[width=\maxwidth]{figure/restOfTheDoc-5} 
\begin{kframe}\begin{alltt}
\hlstd{HIvsLO_treated_STDP}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,groupMDM2Hi_Treated_STDP,groupMDM2Lo_Treated_STDP)}
\hlstd{significant_HIvsLO_treated_STDP}\hlkwb{<-}\hlkwd{filterMyDiff}\hlstd{(HIvsLO_treated_STDP)}

\hlcom{###########################}
\hlcom{# Treated vs Untreated, MDM2Hi, STDP}
\hlcom{###########################}
\hlkwd{volcano_plotter}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Hi_Treated_STDP,}
                                \hlstd{groupMDM2Hi_Untreated_STDP,}
                                \hlstr{"Treated vs Untreated, MDM2Hi, STDP"}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\end{kframe}
\includegraphics[width=\maxwidth]{figure/restOfTheDoc-6} 
\begin{kframe}\begin{alltt}
\hlstd{TreVsUnt_MDM2Hi_STDP}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,groupMDM2Hi_Treated_STDP,groupMDM2Lo_Treated_STDP)}
\hlstd{significant_TreVsUnt_MDM2Hi_STDP}\hlkwb{<-}\hlkwd{filterMyDiff}\hlstd{(TreVsUnt_MDM2Hi_STDP)}


\hlcom{###########################}
\hlcom{# Treated vs Untreated, MDM2Lo, STDP}
\hlcom{###########################}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=}\hlkwd{volcano_plotter}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Lo_Treated_STDP,}
                                \hlstd{groupMDM2Lo_Untreated_STDP,}
                                \hlstr{"Treated vs Untreated, MDM2Lo, STDP"}\hlstd{),}\hlkwc{cols}\hlstd{=}\hlnum{1}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\end{kframe}
\includegraphics[width=\maxwidth]{figure/restOfTheDoc-7} 
\begin{kframe}\begin{alltt}
\hlstd{TreVsUnt_MDM2Lo_STDP}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Lo_Treated_STDP,}
                                \hlstd{groupMDM2Lo_Untreated_STDP)}
\hlstd{significant_TreVsUnt_MDM2Lo_STDP}\hlkwb{<-}\hlkwd{filterMyDiff}\hlstd{(TreVsUnt_MDM2Lo_STDP)}

\hlcom{###########################}
\hlcom{# STDP vs DMEM, MDM2Hi, Untreated}
\hlcom{###########################}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=}\hlkwd{volcano_plotter}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Hi_Untreated_STDP,}
                                \hlstd{groupMDM2Hi_Untreated_DMEM,}
                                \hlstr{"STDP vs DMEM, MDM2Hi, Untreated"}\hlstd{),}\hlkwc{cols}\hlstd{=}\hlnum{1}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\end{kframe}
\includegraphics[width=\maxwidth]{figure/restOfTheDoc-8} 
\begin{kframe}\begin{alltt}
\hlstd{STDPvsDMEM_MDM2Hi_Unt}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Hi_Untreated_STDP,}
                                \hlstd{groupMDM2Hi_Untreated_DMEM)}
\hlstd{significant_STDPvsDMEM_MDM2Hi_Unt}\hlkwb{<-}\hlkwd{filterMyDiff}\hlstd{(STDPvsDMEM_MDM2Hi_Unt)}

\hlcom{###########################}
\hlcom{# STDP vs DMEM, MDM2Lo, Untreated}
\hlcom{###########################}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=}\hlkwd{volcano_plotter}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Lo_Untreated_STDP,}
                                \hlstd{groupMDM2Lo_Untreated_DMEM,}
                                \hlstr{"STDP vs DMEM, MDM2Lo, Untreated"}\hlstd{),}\hlkwc{cols}\hlstd{=}\hlnum{1}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\end{kframe}
\includegraphics[width=\maxwidth]{figure/restOfTheDoc-9} 
\begin{kframe}\begin{alltt}
\hlstd{STDPvsDMEM_MDM2Lo_Unt}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Lo_Untreated_STDP,}
                                \hlstd{groupMDM2Lo_Untreated_DMEM)}
\hlstd{significant_STDPvsDMEM_MDM2Lo_Unt}\hlkwb{<-}\hlkwd{filterMyDiff}\hlstd{(STDPvsDMEM_MDM2Lo_Unt)}

\hlcom{###########################}
\hlcom{# STDP vs DMEM, MDM2Hi, Treated}
\hlcom{###########################}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=}\hlkwd{volcano_plotter}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Hi_Treated_STDP,}
                                \hlstd{groupMDM2Hi_Treated_DMEM,}
                                \hlstr{"STDP vs DMEM, MDM2Hi, Treated"}\hlstd{),}\hlkwc{cols}\hlstd{=}\hlnum{1}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\end{kframe}
\includegraphics[width=\maxwidth]{figure/restOfTheDoc-10} 
\begin{kframe}\begin{alltt}
\hlstd{STDPvsDMEM_MDM2Hi_Tre}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Hi_Treated_STDP,}
                                \hlstd{groupMDM2Hi_Treated_DMEM)}
\hlstd{significant_STDPvsDMEM_MDM2Hi_Tre}\hlkwb{<-}\hlkwd{filterMyDiff}\hlstd{(STDPvsDMEM_MDM2Hi_Tre)}

\hlcom{###########################}
\hlcom{# STDP vs DMEM, MDM2Lo, Treated}
\hlcom{###########################}
\hlkwd{multiplot}\hlstd{(}\hlkwc{plotlist}\hlstd{=}\hlkwd{volcano_plotter}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Lo_Treated_STDP,}
                                \hlstd{groupMDM2Lo_Treated_DMEM,}
                                \hlstr{"STDP vs DMEM, MDM2Lo, Treated"}\hlstd{),}\hlkwc{cols}\hlstd{=}\hlnum{1}\hlstd{)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning: Ignoring unknown aesthetics: text}}\end{kframe}
\includegraphics[width=\maxwidth]{figure/restOfTheDoc-11} 
\begin{kframe}\begin{alltt}
\hlstd{STDPvsDMEM_MDM2Lo_Tre}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(LM_area,}
                                \hlstd{groupMDM2Lo_Treated_STDP,}
                                \hlstd{groupMDM2Lo_Treated_DMEM)}
\hlstd{significant_STDPvsDMEM_MDM2Lo_Tre}\hlkwb{<-}\hlkwd{filterMyDiff}\hlstd{(STDPvsDMEM_MDM2Lo_Tre)}
\end{alltt}
\end{kframe}
\end{knitrout}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{library}\hlstd{(WriteXLS)}
\hlstd{output} \hlkwb{<-} \hlkwd{list}\hlstd{(HIvsLO_untreated_DMEM, HIvsLO_treated_DMEM,HIvsLO_untreated_STDP,HIvsLO_treated_STDP,}
               \hlstd{TreVsUnt_Hi_DMEM,TreVsUnt_Lo_DMEM,TreVsUnt_MDM2Hi_STDP,TreVsUnt_MDM2Lo_STDP,}
               \hlstd{STDPvsDMEM_MDM2Hi_Unt,STDPvsDMEM_MDM2Lo_Unt,STDPvsDMEM_MDM2Hi_Tre,STDPvsDMEM_MDM2Lo_Tre)}
\hlkwd{names}\hlstd{(output)} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlstr{"resMDM2HiLoUntDMEM"}\hlstd{,}\hlstr{"resMDM2HiLoTreDMEM"}\hlstd{,}\hlstr{"resMDM2HiLoUntSTDP"}\hlstd{,}\hlstr{"resMDM2HiLoTreSTDP"}\hlstd{,}
                   \hlstr{"resTreVsUntMDM2HiDMEM"}\hlstd{,}\hlstr{"resTreVsUntMDM2LoDMEM"}\hlstd{,}\hlstr{"resTreVsUntMDM2HiSTDP"}\hlstd{,}\hlstr{"resTreVsUntMDM2LoSTDP"}\hlstd{,}
                   \hlstr{"resSTDPvsDMEMMDM2HiUnt"}\hlstd{,}\hlstr{"resSTDPvsDMEMMDM2LoUnt"}\hlstd{,}\hlstr{"resSTDPvsDMEMMDM2HiTre"}\hlstd{,}\hlstr{"resSTDPvsDMEMMDM2LoTre"}\hlstd{)}
\hlkwd{WriteXLS}\hlstd{(output,}\hlkwc{ExcelFileName} \hlstd{=} \hlstr{"~/Desktop/Liposarcoma project/final_figures/final_lipidomics_results_13019.xlsx"}\hlstd{)}
\end{alltt}
\end{kframe}
\end{knitrout}

Lastly, UpSetR to find intersections.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in eval(expr, envir, enclos): object 'opts\_chunk' not found}}\end{kframe}
\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{library}\hlstd{(UpSetR)}

\hlstd{listInput}\hlkwb{<-}\hlkwd{list}\hlstd{(}\hlkwc{upInHigh_Unt_DMEM}\hlstd{=significant_HIvsLO_untreated_DMEM}\hlopt{$}\hlstd{name[}\hlkwd{which}\hlstd{(significant_HIvsLO_untreated_DMEM}\hlopt{$}\hlstd{log2fc}\hlopt{>}\hlnum{0}\hlstd{)],}
                \hlkwc{upInLow_Unt_DMEM}\hlstd{=significant_HIvsLO_untreated_DMEM}\hlopt{$}\hlstd{name[}\hlkwd{which}\hlstd{(significant_HIvsLO_untreated_DMEM}\hlopt{$}\hlstd{log2fc}\hlopt{<}\hlnum{0}\hlstd{)],}
                \hlkwc{upInHigh_Unt_STDP}\hlstd{=significant_HIvsLO_untreated_STDP}\hlopt{$}\hlstd{name[}\hlkwd{which}\hlstd{(significant_HIvsLO_untreated_STDP}\hlopt{$}\hlstd{log2fc}\hlopt{>}\hlnum{0}\hlstd{)],}
                \hlkwc{upInLow_Unt_STDP}\hlstd{=significant_HIvsLO_untreated_STDP}\hlopt{$}\hlstd{name[}\hlkwd{which}\hlstd{(significant_HIvsLO_untreated_STDP}\hlopt{$}\hlstd{log2fc}\hlopt{<}\hlnum{0}\hlstd{)],}
                \hlkwc{upInHigh_Tre_DMEM}\hlstd{=significant_HIvsLO_treated_DMEM}\hlopt{$}\hlstd{name[}\hlkwd{which}\hlstd{(significant_HIvsLO_treated_DMEM}\hlopt{$}\hlstd{log2fc}\hlopt{>}\hlnum{0}\hlstd{)],}
                \hlkwc{upInLow_Tre_DMEM}\hlstd{=significant_HIvsLO_treated_DMEM}\hlopt{$}\hlstd{name[}\hlkwd{which}\hlstd{(significant_HIvsLO_treated_DMEM}\hlopt{$}\hlstd{log2fc}\hlopt{<}\hlnum{0}\hlstd{)],}
                \hlkwc{upInLow_Tre_STDP}\hlstd{=significant_HIvsLO_treated_STDP}\hlopt{$}\hlstd{name,}
                \hlkwc{upInTre_Lo_STDP}\hlstd{=significant_TreVsUnt_MDM2Lo_STDP}\hlopt{$}\hlstd{name[}\hlkwd{which}\hlstd{(significant_TreVsUnt_MDM2Lo_STDP}\hlopt{$}\hlstd{log2fc}\hlopt{>}\hlnum{0}\hlstd{)],}
                \hlkwc{upInUnt_Lo_STDP}\hlstd{=significant_TreVsUnt_MDM2Lo_STDP}\hlopt{$}\hlstd{name[}\hlkwd{which}\hlstd{(significant_TreVsUnt_MDM2Lo_STDP}\hlopt{$}\hlstd{log2fc}\hlopt{<}\hlnum{0}\hlstd{)],}
                \hlkwc{upInDMEM_Hi_Unt}\hlstd{=significant_STDPvsDMEM_MDM2Hi_Unt}\hlopt{$}\hlstd{name,}
                \hlkwc{upInSTDP_Lo_Unt}\hlstd{=significant_STDPvsDMEM_MDM2Lo_Unt}\hlopt{$}\hlstd{name[}\hlkwd{which}\hlstd{(significant_STDPvsDMEM_MDM2Lo_Unt}\hlopt{$}\hlstd{log2fc}\hlopt{>}\hlnum{0}\hlstd{)],}
                \hlkwc{upInDMEM_Lo_Unt}\hlstd{=significant_STDPvsDMEM_MDM2Lo_Unt}\hlopt{$}\hlstd{name[}\hlkwd{which}\hlstd{(significant_STDPvsDMEM_MDM2Lo_Unt}\hlopt{$}\hlstd{log2fc}\hlopt{<}\hlnum{0}\hlstd{)],}
                \hlkwc{upInSTDP_Hi_Tre}\hlstd{=significant_STDPvsDMEM_MDM2Hi_Tre}\hlopt{$}\hlstd{name[}\hlkwd{which}\hlstd{(significant_STDPvsDMEM_MDM2Hi_Tre}\hlopt{$}\hlstd{log2fc}\hlopt{>}\hlnum{0}\hlstd{)],}
                \hlkwc{upInDMEM_Hi_Tre}\hlstd{=significant_STDPvsDMEM_MDM2Hi_Tre}\hlopt{$}\hlstd{name[}\hlkwd{which}\hlstd{(significant_STDPvsDMEM_MDM2Hi_Tre}\hlopt{$}\hlstd{log2fc}\hlopt{<}\hlnum{0}\hlstd{)],}
                \hlkwc{upInDMEM_Lo_Tre}\hlstd{=significant_STDPvsDMEM_MDM2Lo_Tre}\hlopt{$}\hlstd{name)}

\hlkwd{names}\hlstd{(listInput)}\hlkwb{=}\hlkwd{c}\hlstd{(}\hlstr{"Higher in MDM2-High (Untreated, DMEM)"}\hlstd{,}
                   \hlstr{"Lower in MDM2-High (Untreated, DMEM)"}\hlstd{,}
                   \hlstr{"Higher in MDM2-High (Untreated, STDP)"}\hlstd{,}
                   \hlstr{"Lower in MDM2-High (Untreated, STDP)"}\hlstd{,}
                   \hlstr{"Higher in MDM2-High (Treated, DMEM)"}\hlstd{,}
                   \hlstr{"Lower in MDM2-High (Treated, DMEM)"}\hlstd{,}
                   \hlstr{"Lower in MDM2-High (Treated, STDP)"}\hlstd{,}
                   \hlstr{"Higher in Statin-Treated (MDM2Lo, STDP)"}\hlstd{,}
                   \hlstr{"Lower in Statin-Treated (MDM2Lo, STDP)"}\hlstd{,}
                   \hlstr{"Lower in Sterol-Deprived Media (MDM2Hi, Untreated)"}\hlstd{,}
                   \hlstr{"Higher in Sterol-Deprived Media (MDM2Lo, Untreated)"}\hlstd{,}
                   \hlstr{"Lower in Sterol-Deprived Media (MDM2Lo, Untreated)"}\hlstd{,}
                   \hlstr{"Higher in Sterol-Deprived Media (MDM2Hi, Treated)"}\hlstd{,}
                   \hlstr{"Lower in Sterol-Deprived Media (MDM2Hi, Treated)"}\hlstd{,}
                   \hlstr{"Lower in Sterol-Deprived Media (MDM2Lo, Treated)"}\hlstd{)}

\hlcom{##upset(fromList(listInput), order.by = "freq",nsets=15)}
\hlstd{HiLoMeta}\hlkwb{<-}\hlkwd{data.frame}\hlstd{(sets}\hlkwb{<-}\hlkwd{names}\hlstd{(listInput)[}\hlnum{1}\hlopt{:}\hlnum{7}\hlstd{],}\hlkwc{direction}\hlstd{=}\hlkwd{c}\hlstd{(}\hlstr{"High"}\hlstd{,}\hlstr{"Low"}\hlstd{,}\hlstr{"High"}\hlstd{,}\hlstr{"Low"}\hlstd{,}\hlstr{"High"}\hlstd{,}\hlstr{"Low"}\hlstd{,}\hlstr{"Low"}\hlstd{))}
\hlkwd{upset}\hlstd{(}\hlkwd{fromList}\hlstd{(listInput[}\hlnum{1}\hlopt{:}\hlnum{7}\hlstd{]),} \hlkwc{order.by} \hlstd{=} \hlstr{"freq"}\hlstd{,}\hlkwc{nsets}\hlstd{=}\hlnum{7}\hlstd{,} \hlkwc{set.metadata} \hlstd{=} \hlkwd{list}\hlstd{(}\hlkwc{data}\hlstd{=HiLoMeta,}
                                                                               \hlkwc{plots}\hlstd{=}\hlkwd{list}\hlstd{(}\hlkwd{list}\hlstd{(}\hlkwc{type}\hlstd{=}\hlstr{"matrix_rows"}\hlstd{,}
                                                                                          \hlkwc{column}\hlstd{=}\hlstr{"direction"}\hlstd{,}
                                                                                          \hlkwc{colors}\hlstd{=}\hlkwd{c}\hlstd{(}\hlkwc{High}\hlstd{=}\hlstr{"red"}\hlstd{,}
                                                                                                   \hlkwc{Low}\hlstd{=}\hlstr{"blue"}\hlstd{),}
                                                                                          \hlkwc{alpha}\hlstd{=}\hlnum{0.5}\hlstd{))))}
\hlkwd{grid.text}\hlstd{(}\hlstr{"Changes related to MDM2 status"}\hlstd{,}\hlkwc{x} \hlstd{=} \hlnum{0.65}\hlstd{,} \hlkwc{y}\hlstd{=}\hlnum{0.95}\hlstd{,} \hlkwc{gp}\hlstd{=}\hlkwd{gpar}\hlstd{(}\hlkwc{fontsize}\hlstd{=}\hlnum{20}\hlstd{))}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/UpSetR-1} 
\begin{kframe}\begin{alltt}
\hlstd{MediaMeta}\hlkwb{<-}\hlkwd{data.frame}\hlstd{(}\hlkwc{sets}\hlstd{=}\hlkwd{names}\hlstd{(listInput)[}\hlnum{10}\hlopt{:}\hlnum{15}\hlstd{],}\hlkwc{direction}\hlstd{=}\hlkwd{c}\hlstd{(}\hlstr{"DMEM"}\hlstd{,}\hlstr{"STDP"}\hlstd{,}\hlstr{"DMEM"}\hlstd{,}\hlstr{"STDP"}\hlstd{,}\hlstr{"DMEM"}\hlstd{,}\hlstr{"DMEM"}\hlstd{))}
\hlkwd{upset}\hlstd{(}\hlkwd{fromList}\hlstd{(listInput[}\hlnum{10}\hlopt{:}\hlnum{15}\hlstd{]),} \hlkwc{order.by} \hlstd{=} \hlstr{"freq"}\hlstd{,}\hlkwc{nsets}\hlstd{=}\hlnum{6}\hlstd{,} \hlkwc{set.metadata} \hlstd{=} \hlkwd{list}\hlstd{(}\hlkwc{data}\hlstd{=MediaMeta,}
                                                                               \hlkwc{plots}\hlstd{=}\hlkwd{list}\hlstd{(}\hlkwd{list}\hlstd{(}\hlkwc{type}\hlstd{=}\hlstr{"matrix_rows"}\hlstd{,}
                                                                                          \hlkwc{column}\hlstd{=}\hlstr{"direction"}\hlstd{,}
                                                                                          \hlkwc{colors}\hlstd{=}\hlkwd{c}\hlstd{(}\hlkwc{DMEM}\hlstd{=}\hlstr{"green"}\hlstd{,}
                                                                                                   \hlkwc{STDP}\hlstd{=}\hlstr{"purple"}\hlstd{),}
                                                                                          \hlkwc{alpha}\hlstd{=}\hlnum{0.5}\hlstd{))))}
\hlkwd{grid.text}\hlstd{(}\hlstr{"Changes related to Growth Media"}\hlstd{,}\hlkwc{x} \hlstd{=} \hlnum{0.65}\hlstd{,} \hlkwc{y}\hlstd{=}\hlnum{0.95}\hlstd{,} \hlkwc{gp}\hlstd{=}\hlkwd{gpar}\hlstd{(}\hlkwc{fontsize}\hlstd{=}\hlnum{20}\hlstd{))}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/UpSetR-2} 
\begin{kframe}\begin{alltt}
\hlstd{listInputConcat}\hlkwb{<-}\hlkwd{list}\hlstd{(significant_HIvsLO_untreated_DMEM}\hlopt{$}\hlstd{name,}
                      \hlstd{significant_HIvsLO_untreated_STDP}\hlopt{$}\hlstd{name,}
                       \hlstd{significant_HIvsLO_treated_DMEM}\hlopt{$}\hlstd{name,}
                       \hlstd{significant_HIvsLO_treated_STDP}\hlopt{$}\hlstd{name)}

\hlkwd{names}\hlstd{(listInputConcat)} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlstr{"Untreated, Normal Media"}\hlstd{,}
                            \hlstr{"Untreated, Sterol Deprived Media"}\hlstd{,}
                            \hlstr{"Treated, Normal Media"}\hlstd{,}
                            \hlstr{"Treated, Sterol Deprived Media"}\hlstd{)}

\hlkwd{pdf}\hlstd{(}\hlstr{"~/Desktop/UpsetR_MDM2HiLo_lipidomic.pdf"}\hlstd{,}\hlkwc{width}\hlstd{=}\hlnum{12}\hlstd{,}\hlkwc{height}\hlstd{=}\hlnum{8}\hlstd{)}
\hlkwd{upset}\hlstd{(}\hlkwd{fromList}\hlstd{(listInputConcat),} \hlkwc{order.by} \hlstd{=} \hlstr{"freq"}\hlstd{,}\hlkwc{nsets}\hlstd{=}\hlnum{4}\hlstd{)}
\hlkwd{grid.text}\hlstd{(}\hlstr{"Changes related to MDM2 status"}\hlstd{,}\hlkwc{x} \hlstd{=} \hlnum{0.65}\hlstd{,} \hlkwc{y}\hlstd{=}\hlnum{0.95}\hlstd{,} \hlkwc{gp}\hlstd{=}\hlkwd{gpar}\hlstd{(}\hlkwc{fontsize}\hlstd{=}\hlnum{20}\hlstd{))}
\hlkwd{dev.off}\hlstd{()}
\end{alltt}
\begin{verbatim}
## pdf 
##   2
\end{verbatim}
\end{kframe}
\end{knitrout}

Worth noting there were 2 sphingomyelins higher in MDM2 low across all
4 experiments, 5 higher in MDM2 low in 1 experiment, and 1 higher in
MDM2 high in 3 experiments

\section{Pathway Analysis}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{library}\hlstd{(tidyverse)}
\end{alltt}


{\ttfamily\noindent\itshape\color{messagecolor}{\#\# -- Attaching packages ---------------------------------- tidyverse 1.2.1 --}}

{\ttfamily\noindent\itshape\color{messagecolor}{\#\# v tidyr\ \  0.8.1\ \ \ \  v purrr\ \  0.2.5\\\#\# v readr\ \  1.1.1\ \ \ \  v stringr 1.3.1\\\#\# v tidyr\ \  0.8.1\ \ \ \  v forcats 0.3.0}}

{\ttfamily\noindent\itshape\color{messagecolor}{\#\# -- Conflicts ------------------------------------- tidyverse\_conflicts() --\\\#\# x tidyr::expand() masks reshape::expand()\\\#\# x dplyr::filter() masks stats::filter()\\\#\# x dplyr::lag()\ \ \ \ masks stats::lag()\\\#\# x dplyr::rename() masks reshape::rename()}}\begin{alltt}
\hlkwd{library}\hlstd{(readxl)}
\hlstd{lipidMatch_table}\hlkwb{<-}\hlkwd{read_xlsx}\hlstd{(}\hlstr{"~/Desktop/Pathway_Analysis/LipidMatch_KEGGPathways.xlsx"}\hlstd{)}
\hlstd{lipidMatch_table}\hlkwb{<-}\hlkwd{drop_na}\hlstd{(lipidMatch_table,`Pathway(s)`)}

\hlstd{df} \hlkwb{<-} \hlstd{LM_area}
\hlstd{gp1} \hlkwb{<-} \hlstd{groupMDM2Hi_Untreated_DMEM}
\hlstd{gp2} \hlkwb{<-} \hlstd{groupMDM2Lo_Untreated_DMEM}

\hlstd{T_test_results}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(df,gp1,gp2)}
\hlstd{T_test_results}\hlopt{$}\hlstd{significant} \hlkwb{=} \hlkwd{abs}\hlstd{(T_test_results}\hlopt{$}\hlstd{log2fc)} \hlopt{>} \hlnum{1} \hlopt{& -}\hlkwd{log10}\hlstd{(T_test_results}\hlopt{$}\hlstd{mypadj)} \hlopt{> -}\hlkwd{log10}\hlstd{(}\hlnum{0.05}\hlstd{)}

\hlstd{lipid_classes}\hlkwb{<-}\hlkwd{sapply}\hlstd{(lipid_list,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)}
    \hlkwd{gsub}\hlstd{(}\hlstr{"\textbackslash{}\textbackslash{}s*\textbackslash{}\textbackslash{}([^\textbackslash{}\textbackslash{})]+\textbackslash{}\textbackslash{})"}\hlstd{,}\hlstr{""}\hlstd{,}\hlkwd{as.character}\hlstd{(x)))}
\hlstd{lipid_classes}\hlkwb{<-}\hlkwd{sapply}\hlstd{(lipid_classes,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)}
    \hlkwd{gsub}\hlstd{(}\hlstr{")"}\hlstd{,}\hlstr{""}\hlstd{,}\hlkwd{as.character}\hlstd{(x)))}
\hlstd{lipid_classes}\hlkwb{<-}\hlkwd{sapply}\hlstd{(lipid_classes,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)}
    \hlkwd{gsub}\hlstd{(}\hlstr{"_16:1"}\hlstd{,}\hlstr{""}\hlstd{,}\hlkwd{as.character}\hlstd{(x)))}
\hlstd{T_test_results}\hlopt{$}\hlstd{superClass}\hlkwb{<-}\hlstd{lipidClassKey}\hlopt{$}\hlstd{Class[}\hlkwd{match}\hlstd{(lipid_classes,lipidClassKey}\hlopt{$}\hlstd{Abbreviation)]}
\hlstd{T_test_results}\hlopt{$}\hlstd{class}\hlkwb{<-}\hlkwd{as.factor}\hlstd{(lipid_classes)}

\hlstd{KEGG_ID} \hlkwb{<-} \hlstd{lipidMatch_table}\hlopt{$}\hlstd{`KEGG ID`[}\hlkwd{match}\hlstd{(T_test_results}\hlopt{$}\hlstd{class,lipidMatch_table}\hlopt{$}\hlstd{Class)]}
\hlstd{KEGG_ID}\hlkwb{<-}\hlkwd{paste0}\hlstd{(}\hlstr{"kegg:"}\hlstd{,KEGG_ID)}
\hlstd{T_test_results}\hlopt{$}\hlstd{KEGG_ID} \hlkwb{<-} \hlstd{KEGG_ID}

\hlcom{## Pathways <- lipidMatch_table$`Pathway(s)`[match(T_test_results$class,lipidMatch_table$Class)]}
\hlcom{## T_test_results$Pathways <- Pathways}

\hlcom{## Pathway_list<-lapply(Pathways,function(x) strsplit(gsub("[^[:alnum:] ]", "", x), " +")[[1]])}
\hlkwd{library}\hlstd{(RMySQL)}
\end{alltt}


{\ttfamily\noindent\itshape\color{messagecolor}{\#\# Loading required package: DBI}}\begin{alltt}
\hlstd{con} \hlkwb{<-} \hlkwd{dbConnect}\hlstd{(}\hlkwd{MySQL}\hlstd{(),}
         \hlkwc{user}\hlstd{=}\hlstr{"root"}\hlstd{,} \hlkwc{password}\hlstd{=}\hlstr{""}\hlstd{,}
         \hlkwc{dbname}\hlstd{=}\hlstr{"ramp"}\hlstd{,} \hlkwc{host}\hlstd{=}\hlstr{"localhost"}\hlstd{)}
\hlkwd{on.exit}\hlstd{(}\hlkwd{dbDisconnect}\hlstd{(con))}

\hlstd{compound_IDs}\hlkwb{<-}\hlkwd{c}\hlstd{()}
\hlstd{pathway_list}\hlkwb{<-}\hlkwd{c}\hlstd{()}
\hlkwa{for}\hlstd{(i} \hlkwa{in} \hlstd{KEGG_ID)\{}
    \hlstd{rs} \hlkwb{<-} \hlkwd{dbSendQuery}\hlstd{(con,} \hlkwd{paste0}\hlstd{(}\hlstr{"select pathwayRampId from analytehaspathway where rampId = (select rampId from source where sourceId = \textbackslash{}'"}\hlstd{,i,}\hlstr{"\textbackslash{}');"}\hlstd{))}
    \hlstd{pathways} \hlkwb{<-} \hlkwd{fetch}\hlstd{(rs,} \hlkwc{n}\hlstd{=}\hlopt{-}\hlnum{1}\hlstd{)}
    \hlstd{huh} \hlkwb{<-} \hlkwd{dbHasCompleted}\hlstd{(rs)}
    \hlkwd{dbClearResult}\hlstd{(rs)}
    \hlkwd{ifelse}\hlstd{(}\hlkwd{nrow}\hlstd{(pathways)}\hlopt{!=}\hlnum{0}\hlstd{,pathwayName_vector}\hlkwb{<-}\hlkwd{as.matrix}\hlstd{(pathways),pathwayName_vector}\hlkwb{<-}\hlstr{"No pathway information"}\hlstd{)}
    \hlstd{pathwayName_vector}\hlkwb{<-}\hlkwd{paste}\hlstd{(pathwayName_vector,}\hlkwc{collapse}\hlstd{=}\hlstr{"; "}\hlstd{)}
    \hlstd{pathway_list}\hlkwb{<-}\hlkwd{c}\hlstd{(pathway_list,pathwayName_vector)}
    \hlstd{compound_IDs}\hlkwb{<-}\hlkwd{c}\hlstd{(compound_IDs,i)}
    \hlcom{## if(nrow(pathways)!=0)\{}
    \hlcom{##     for(j in as.vector(as.matrix(pathways)))\{}
    \hlcom{##         rs <- dbSendQuery(con, paste0("select pathwayName from pathway where pathwayRampId =\textbackslash{}'",j,"\textbackslash{}';"))}
    \hlcom{##         pathwayName <- fetch(rs, n=-1)}
    \hlcom{##         huh <- dbHasCompleted(rs)}
    \hlcom{##         dbClearResult(rs)}
    \hlcom{##         pathwayName_vector<-c(pathwayName_vector,pathwayName)}
    \hlcom{##     \}}
    \hlcom{##     pathwayName_vector<-unique(pathwayName_vector)}
    \hlcom{##     pathwayName_vector<-paste(pathwayName_vector,collapse="; ")}
    \hlcom{##     pathway_list<-c(pathway_list,pathwayName_vector)}
    \hlcom{##     compound_IDs<-c(compound_IDs,i)}
    \hlcom{## \} else \{}
    \hlcom{##     pathwayName_vector<-"No pathway information"}
    \hlcom{##     pathway_list<-c(pathway_list,pathwayName_vector)}
    \hlcom{##     compound_IDs<-c(compound_IDs,i)}
    \hlcom{## \}}
\hlstd{\}}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in .local(dbObj, ...): internal error in RS\_DBI\_getConnection: corrupt connection handle}}\begin{alltt}
\hlstd{pathway_list}\hlkwb{<-}\hlkwd{lapply}\hlstd{(pathway_list,}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwd{strsplit}\hlstd{(x,}\hlkwc{split}\hlstd{=}\hlstr{"; "}\hlstd{))}

\hlstd{pathway_composition}\hlkwb{<-}\hlkwd{lapply}\hlstd{(}\hlkwd{unique}\hlstd{(}\hlkwd{unlist}\hlstd{(pathway_list)),} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}
    \hlstd{rs} \hlkwb{<-} \hlkwd{dbSendQuery}\hlstd{(con,} \hlkwd{paste0}\hlstd{(}\hlstr{"select * from analytehaspathway where pathwayRampId = \textbackslash{}'"}\hlstd{,x,}\hlstr{"\textbackslash{}';"}\hlstd{))}
    \hlkwd{return}\hlstd{(pathways} \hlkwb{<-} \hlkwd{fetch}\hlstd{(rs,} \hlkwc{n}\hlstd{=}\hlopt{-}\hlnum{1}\hlstd{))}
    \hlstd{huh} \hlkwb{<-} \hlkwd{dbHasCompleted}\hlstd{(rs)}
    \hlkwd{dbClearResult}\hlstd{(rs)}
\hlstd{\})}
\hlstd{pathway_composition[[}\hlnum{1}\hlstd{]]}\hlkwb{<-}\hlkwa{NULL}
\hlstd{pathway_composition}\hlkwb{<-}\hlkwd{lapply}\hlstd{(pathway_composition,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}
    \hlstd{compounds}\hlkwb{<-} \hlstd{x} \hlopt{%>%} \hlkwd{filter}\hlstd{(}\hlkwd{grepl}\hlstd{(}\hlstr{"_C_"}\hlstd{,rampId))} \hlopt{%>%} \hlkwd{select}\hlstd{(rampId)}
\hlstd{\})}

\hlstd{pathway_kegg_composition}\hlkwb{<-}\hlkwd{list}\hlstd{()}
\hlstd{k}\hlkwb{=}\hlnum{1}
\hlkwa{for}\hlstd{(i} \hlkwa{in} \hlstd{pathway_composition)\{}
    \hlstd{kegg_ids}\hlkwb{<-}\hlkwd{as.vector}\hlstd{(i)}
    \hlkwa{for}\hlstd{(j} \hlkwa{in} \hlnum{1}\hlopt{:}\hlkwd{nrow}\hlstd{(i))\{}
        \hlstd{id} \hlkwb{<-} \hlkwd{dbGetQuery}\hlstd{(con,} \hlkwd{paste0}\hlstd{(}\hlstr{"select * from source where rampId = \textbackslash{}'"}\hlstd{,i[j,],}\hlstr{"\textbackslash{}' and IDtype = 'kegg';"}\hlstd{))}
        \hlcom{#print(j)}
        \hlkwa{if}\hlstd{(}\hlkwd{nrow}\hlstd{(id)}\hlopt{!=}\hlnum{0}\hlstd{)\{}
            \hlcom{# Take the first result if there's more then one. This should be looked at}
            \hlstd{kegg_ids[[j]]}\hlkwb{<-}\hlstd{id}\hlopt{$}\hlstd{sourceId[}\hlnum{1}\hlstd{]}
        \hlstd{\}}
    \hlstd{\}}
    \hlstd{pathway_kegg_composition[[k]]}\hlkwb{<-}\hlstd{kegg_ids[}\hlnum{1}\hlstd{,]}
    \hlstd{k}\hlkwb{=}\hlstd{k}\hlopt{+}\hlnum{1}
\hlstd{\}}

\hlkwd{names}\hlstd{(pathway_kegg_composition)}\hlkwb{<-}\hlkwd{unique}\hlstd{(}\hlkwd{unlist}\hlstd{(pathway_list))[}\hlopt{-}\hlnum{1}\hlstd{]}

\hlkwd{save}\hlstd{(pathway_kegg_composition,T_test_results,}\hlkwc{file}\hlstd{=}\hlstr{"data/pathway_kegg_composition_1_29_19.Rda"}\hlstd{)}
\end{alltt}
\end{kframe}
\end{knitrout}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{load}\hlstd{(}\hlstr{"data/pathway_kegg_composition_1_29_19.Rda"}\hlstd{)}
\hlkwd{library}\hlstd{(stats)}

\hlcom{# Don't look at pathways that are too big or too small}
\hlstd{pathway_length} \hlkwb{<-} \hlkwd{sapply}\hlstd{(pathway_kegg_composition,length)}
\hlstd{pathway_kegg_composition} \hlkwb{<-} \hlstd{pathway_kegg_composition[}\hlopt{-}\hlkwd{which}\hlstd{(pathway_length} \hlopt{<} \hlnum{10} \hlopt{|} \hlstd{pathway_length} \hlopt{>} \hlnum{500}\hlstd{)]}

\hlstd{T_test_results_sig} \hlkwb{<-} \hlstd{T_test_results} \hlopt{%>%} \hlkwd{filter}\hlstd{(significant} \hlopt{==} \hlnum{TRUE}\hlstd{)}

\hlstd{pathway_analysis_results}\hlkwb{<-}\hlkwd{lapply}\hlstd{(pathway_kegg_composition,}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}
    \hlstd{contingency_table}\hlkwb{<-}\hlkwd{matrix}\hlstd{(}\hlkwc{nrow}\hlstd{=}\hlnum{2}\hlstd{,}\hlkwc{ncol}\hlstd{=}\hlnum{2}\hlstd{)}
    \hlkwd{colnames}\hlstd{(contingency_table)}\hlkwb{<-}\hlkwd{c}\hlstd{(}\hlstr{"Significant"}\hlstd{,}\hlstr{"Not Significant"}\hlstd{)}
    \hlkwd{rownames}\hlstd{(contingency_table)}\hlkwb{<-}\hlkwd{c}\hlstd{(}\hlstr{"In Pathway"}\hlstd{,} \hlstr{"Not in Pathway"}\hlstd{)}
    \hlstd{contingency_table[}\hlnum{1}\hlstd{,}\hlnum{1}\hlstd{]}\hlkwb{<-}\hlkwd{length}\hlstd{(}\hlkwd{intersect}\hlstd{(T_test_results}\hlopt{$}\hlstd{KEGG_ID[}\hlkwd{which}\hlstd{(T_test_results}\hlopt{$}\hlstd{significant)],x))}
    \hlstd{contingency_table[}\hlnum{1}\hlstd{,}\hlnum{2}\hlstd{]}\hlkwb{<-}\hlkwd{length}\hlstd{(}\hlkwd{intersect}\hlstd{(T_test_results}\hlopt{$}\hlstd{KEGG_ID[}\hlkwd{which}\hlstd{(}\hlopt{!}\hlstd{T_test_results}\hlopt{$}\hlstd{significant)],x))}
    \hlstd{contingency_table[}\hlnum{2}\hlstd{,}\hlnum{1}\hlstd{]}\hlkwb{<-}\hlkwd{length}\hlstd{(}\hlkwd{which}\hlstd{(T_test_results}\hlopt{$}\hlstd{significant))}\hlopt{-}\hlstd{contingency_table[}\hlnum{1}\hlstd{,}\hlnum{1}\hlstd{]}
    \hlstd{contingency_table[}\hlnum{2}\hlstd{,}\hlnum{2}\hlstd{]}\hlkwb{<-}\hlkwd{length}\hlstd{(}\hlkwd{which}\hlstd{(}\hlopt{!}\hlstd{T_test_results}\hlopt{$}\hlstd{significant))}\hlopt{-}\hlstd{contingency_table[}\hlnum{1}\hlstd{,}\hlnum{2}\hlstd{]}
    \hlstd{p_val} \hlkwb{<-} \hlkwd{fisher.test}\hlstd{(contingency_table)}\hlopt{$}\hlstd{p.value}
    \hlstd{sig_lipids}\hlkwb{<-}\hlkwd{data.frame}\hlstd{(}\hlkwc{Lipid}\hlstd{=}\hlnum{NA}\hlstd{,}\hlkwc{KEGG}\hlstd{=}\hlnum{NA}\hlstd{,}\hlkwc{log2FC}\hlstd{=}\hlnum{NA}\hlstd{)}
    \hlkwa{for}\hlstd{(i} \hlkwa{in} \hlkwd{as.vector}\hlstd{(}\hlkwd{as.matrix}\hlstd{(x)))\{}
        \hlkwa{if}\hlstd{(i} \hlopt{%in%} \hlstd{T_test_results_sig}\hlopt{$}\hlstd{KEGG_ID)\{}
            \hlstd{ind}\hlkwb{<-}\hlkwd{which}\hlstd{(T_test_results_sig}\hlopt{$}\hlstd{KEGG_ID}\hlopt{==}\hlstd{i)}
            \hlkwa{if}\hlstd{(}\hlkwd{length}\hlstd{(ind)}\hlopt{!=}\hlnum{0}\hlstd{)\{}
                \hlstd{sig_lipids} \hlkwb{<-} \hlkwd{rbind}\hlstd{(sig_lipids,}\hlkwd{data.frame}\hlstd{(}\hlkwc{Lipid}\hlstd{=}\hlkwd{as.vector}\hlstd{(T_test_results_sig}\hlopt{$}\hlstd{name)[ind],} \hlkwc{KEGG}\hlstd{=}\hlkwd{as.vector}\hlstd{(T_test_results_sig}\hlopt{$}\hlstd{KEGG_ID)[ind],}\hlkwc{log2FC}\hlstd{=}\hlkwd{as.vector}\hlstd{(T_test_results_sig}\hlopt{$}\hlstd{log2fc)[ind]))}
            \hlstd{\}}
        \hlstd{\}}
    \hlstd{\}}
    \hlstd{sig_lipids}\hlkwb{<-}\hlstd{sig_lipids[}\hlopt{-}\hlnum{1}\hlstd{,]}
    \hlstd{sig_lipids}\hlopt{$}\hlstd{pathway_p_val}\hlkwb{<-}\hlkwd{rep}\hlstd{(p_val,}\hlkwc{times}\hlstd{=}\hlkwd{nrow}\hlstd{(sig_lipids))}
    \hlkwd{return}\hlstd{(sig_lipids)}
\hlstd{\})}

\hlstd{pathway_analysis_results} \hlkwb{<-} \hlstd{pathway_analysis_results[}\hlopt{-}\hlkwd{which}\hlstd{(}\hlkwd{sapply}\hlstd{(pathway_analysis_results,nrow)}\hlopt{==}\hlnum{1} \hlopt{|} \hlkwd{sapply}\hlstd{(pathway_analysis_results,nrow)}\hlopt{==}\hlnum{0}\hlstd{)]}


\hlstd{p_values} \hlkwb{<-} \hlkwd{as.numeric}\hlstd{(}\hlkwd{sapply}\hlstd{(pathway_analysis_results,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}\hlkwd{return}\hlstd{(x[}\hlnum{1}\hlstd{,}\hlnum{4}\hlstd{])\}))}
\hlstd{pathway_analysis_results} \hlkwb{<-} \hlstd{pathway_analysis_results[}\hlkwd{order}\hlstd{(p_values)]}
\hlkwd{hist}\hlstd{(p_values)}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in hist.default(p\_values): invalid number of 'breaks'}}\begin{alltt}
\hlkwd{library}\hlstd{(RMySQL)}
\hlstd{con} \hlkwb{<-} \hlkwd{dbConnect}\hlstd{(}\hlkwd{MySQL}\hlstd{(),}
         \hlkwc{user}\hlstd{=}\hlstr{"root"}\hlstd{,} \hlkwc{password}\hlstd{=}\hlstr{""}\hlstd{,}
         \hlkwc{dbname}\hlstd{=}\hlstr{"ramp"}\hlstd{,} \hlkwc{host}\hlstd{=}\hlstr{"localhost"}\hlstd{)}
\hlkwd{on.exit}\hlstd{(}\hlkwd{dbDisconnect}\hlstd{(con))}

\hlstd{pathway_names}\hlkwb{<-}\hlkwd{sapply}\hlstd{(}\hlkwd{names}\hlstd{(pathway_analysis_results),} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}
    \hlstd{rs} \hlkwb{<-} \hlkwd{dbSendQuery}\hlstd{(con,} \hlkwd{paste0}\hlstd{(}\hlstr{"select pathwayName from pathway where pathwayRampId = \textbackslash{}'"}\hlstd{,x,}\hlstr{"\textbackslash{}';"}\hlstd{))}
    \hlkwd{return}\hlstd{(pathways} \hlkwb{<-} \hlkwd{fetch}\hlstd{(rs,} \hlkwc{n}\hlstd{=}\hlopt{-}\hlnum{1}\hlstd{))}
    \hlstd{huh} \hlkwb{<-} \hlkwd{dbHasCompleted}\hlstd{(rs)}
    \hlkwd{dbClearResult}\hlstd{(rs)}
\hlstd{\})}

\hlstd{pathway_names} \hlkwb{<-} \hlkwd{paste0}\hlstd{(pathway_names,}\hlstr{", p = "}\hlstd{,} \hlkwd{sort}\hlstd{(p_values))}
\hlcom{## Return a list with pathway IDs/pvalues as names and then each significant lipid with foldchange within each entry}
\hlkwd{names}\hlstd{(pathway_analysis_results)} \hlkwb{=} \hlstd{pathway_names}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in names(pathway\_analysis\_results) = pathway\_names: 'names' attribute [1] must be the same length as the vector [0]}}\begin{alltt}
\hlstd{significant_lipid_pathways}\hlkwb{<-}\hlstd{pathway_analysis_results[}\hlnum{1}\hlopt{:}\hlnum{7}\hlstd{]}
\hlstd{significant_lipid_pathways}\hlkwb{<-}\hlkwd{lapply}\hlstd{(significant_lipid_pathways,}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}
    \hlkwd{return}\hlstd{(}\hlkwd{cbind}\hlstd{(x}\hlopt{$}\hlstd{Lipid,x}\hlopt{$}\hlstd{log2FC))}
\hlstd{\})}
\end{alltt}
\end{kframe}
\end{knitrout}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{classFishersAnalysis}\hlkwb{<-}\hlkwa{function}\hlstd{(}\hlkwc{gp1}\hlstd{,}\hlkwc{gp2}\hlstd{)\{}
    \hlstd{df} \hlkwb{<-} \hlstd{LM_area}

    \hlstd{T_test_results}\hlkwb{<-}\hlkwd{mydiff}\hlstd{(df,gp1,gp2)}
    \hlstd{T_test_results}\hlopt{$}\hlstd{significant} \hlkwb{=} \hlkwd{abs}\hlstd{(T_test_results}\hlopt{$}\hlstd{log2fc)} \hlopt{>} \hlnum{1} \hlopt{& -}\hlkwd{log10}\hlstd{(T_test_results}\hlopt{$}\hlstd{mypadj)} \hlopt{> -}\hlkwd{log10}\hlstd{(}\hlnum{0.05}\hlstd{)}

    \hlstd{lipid_classes}\hlkwb{<-}\hlkwd{sapply}\hlstd{(lipid_list,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)}
        \hlkwd{gsub}\hlstd{(}\hlstr{"\textbackslash{}\textbackslash{}s*\textbackslash{}\textbackslash{}([^\textbackslash{}\textbackslash{})]+\textbackslash{}\textbackslash{})"}\hlstd{,}\hlstr{""}\hlstd{,}\hlkwd{as.character}\hlstd{(x)))}
    \hlstd{lipid_classes}\hlkwb{<-}\hlkwd{sapply}\hlstd{(lipid_classes,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)}
        \hlkwd{gsub}\hlstd{(}\hlstr{")"}\hlstd{,}\hlstr{""}\hlstd{,}\hlkwd{as.character}\hlstd{(x)))}
    \hlstd{lipid_classes}\hlkwb{<-}\hlkwd{sapply}\hlstd{(lipid_classes,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)}
        \hlkwd{gsub}\hlstd{(}\hlstr{"_16:1"}\hlstd{,}\hlstr{""}\hlstd{,}\hlkwd{as.character}\hlstd{(x)))}
    \hlstd{T_test_results}\hlopt{$}\hlstd{superClass}\hlkwb{<-}\hlstd{lipidClassKey}\hlopt{$}\hlstd{Class[}\hlkwd{match}\hlstd{(lipid_classes,lipidClassKey}\hlopt{$}\hlstd{Abbreviation)]}
    \hlstd{T_test_results}\hlopt{$}\hlstd{class}\hlkwb{<-}\hlkwd{as.factor}\hlstd{(lipid_classes)}

    \hlstd{KEGG_ID} \hlkwb{<-} \hlstd{lipidMatch_table}\hlopt{$}\hlstd{`KEGG ID`[}\hlkwd{match}\hlstd{(T_test_results}\hlopt{$}\hlstd{class,lipidMatch_table}\hlopt{$}\hlstd{Class)]}
    \hlstd{KEGG_ID}\hlkwb{<-}\hlkwd{paste0}\hlstd{(}\hlstr{"kegg:"}\hlstd{,KEGG_ID)}
    \hlstd{T_test_results}\hlopt{$}\hlstd{KEGG_ID} \hlkwb{<-} \hlstd{KEGG_ID}
    \hlstd{UpInGp1} \hlkwb{<-} \hlstd{T_test_results} \hlopt{%>%} \hlkwd{filter}\hlstd{(log2fc} \hlopt{>} \hlnum{0}\hlstd{)}
    \hlstd{UpInGp2} \hlkwb{<-} \hlstd{T_test_results} \hlopt{%>%} \hlkwd{filter}\hlstd{(log2fc} \hlopt{<} \hlnum{0}\hlstd{)}
    \hlstd{framelist}\hlkwb{<-}\hlkwd{list}\hlstd{(UpInGp1,UpInGp2)}
    \hlstd{resultsList}\hlkwb{<-}\hlkwd{list}\hlstd{()}
    \hlstd{j}\hlkwb{=}\hlnum{1}
    \hlkwa{for}\hlstd{(i} \hlkwa{in} \hlstd{framelist)\{}
        \hlstd{significant_classes} \hlkwb{<-} \hlkwd{as.vector}\hlstd{(}\hlkwd{t}\hlstd{(}\hlkwd{unique}\hlstd{(i} \hlopt{%>%} \hlkwd{filter}\hlstd{(significant}\hlopt{==}\hlnum{TRUE}\hlstd{)} \hlopt{%>%} \hlkwd{select}\hlstd{(class))))}
        \hlstd{class_fisher_results}\hlkwb{<-}\hlkwd{sapply}\hlstd{(significant_classes,}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}
            \hlstd{contingency_table}\hlkwb{<-}\hlkwd{matrix}\hlstd{(}\hlkwc{nrow}\hlstd{=}\hlnum{2}\hlstd{,}\hlkwc{ncol}\hlstd{=}\hlnum{2}\hlstd{)}
            \hlkwd{colnames}\hlstd{(contingency_table)}\hlkwb{<-}\hlkwd{c}\hlstd{(}\hlstr{"Significant"}\hlstd{,}\hlstr{"Not Significant"}\hlstd{)}
            \hlkwd{rownames}\hlstd{(contingency_table)}\hlkwb{<-}\hlkwd{c}\hlstd{(}\hlstr{"In Class"}\hlstd{,} \hlstr{"Not in Class"}\hlstd{)}
            \hlstd{contingency_table[}\hlnum{1}\hlstd{,}\hlnum{1}\hlstd{]}\hlkwb{<-}\hlkwd{nrow}\hlstd{(i} \hlopt{%>%} \hlkwd{filter}\hlstd{(class} \hlopt{==} \hlstd{x} \hlopt{&} \hlstd{significant))}
            \hlstd{contingency_table[}\hlnum{1}\hlstd{,}\hlnum{2}\hlstd{]}\hlkwb{<-}\hlkwd{nrow}\hlstd{(i} \hlopt{%>%} \hlkwd{filter}\hlstd{(class} \hlopt{==} \hlstd{x} \hlopt{& !}\hlstd{significant))}
            \hlstd{contingency_table[}\hlnum{2}\hlstd{,}\hlnum{1}\hlstd{]}\hlkwb{<-}\hlkwd{nrow}\hlstd{(T_test_results} \hlopt{%>%} \hlkwd{filter}\hlstd{(class} \hlopt{!=} \hlstd{x} \hlopt{&} \hlstd{significant))}
            \hlstd{contingency_table[}\hlnum{2}\hlstd{,}\hlnum{2}\hlstd{]}\hlkwb{<-}\hlkwd{nrow}\hlstd{(T_test_results} \hlopt{%>%} \hlkwd{filter}\hlstd{(class} \hlopt{!=} \hlstd{x} \hlopt{& !}\hlstd{significant))}
            \hlstd{p_val} \hlkwb{<-} \hlkwd{fisher.test}\hlstd{(contingency_table)}\hlopt{$}\hlstd{p.value}
            \hlkwd{return}\hlstd{(p_val)}
    \hlstd{\})}
        \hlkwd{names}\hlstd{(class_fisher_results)} \hlkwb{<-} \hlstd{significant_classes}
        \hlkwa{if}\hlstd{(}\hlkwd{length}\hlstd{(class_fisher_results)}\hlopt{!=}\hlnum{0}\hlstd{)\{}
            \hlstd{class_fisher_results} \hlkwb{<-} \hlkwd{sort}\hlstd{(class_fisher_results)}
        \hlstd{\}}
        \hlstd{resultsList[[j]]} \hlkwb{<-} \hlstd{class_fisher_results}
        \hlstd{j} \hlkwb{=} \hlstd{j} \hlopt{+} \hlnum{1}
    \hlstd{\}}
    \hlkwd{names}\hlstd{(resultsList)}\hlkwb{<-}\hlkwd{c}\hlstd{(}\hlstr{"Higher in group 1"}\hlstd{,} \hlstr{"Higher in group 2"}\hlstd{)}
    \hlkwd{return}\hlstd{(resultsList)}
\hlstd{\}}

\hlstd{HiLoUTDMEMFish}\hlkwb{<-}\hlkwd{classFishersAnalysis}\hlstd{(groupMDM2Hi_Untreated_DMEM,groupMDM2Lo_Untreated_DMEM)}
\hlstd{HiLoTrDMEMFish}\hlkwb{<-}\hlkwd{classFishersAnalysis}\hlstd{(groupMDM2Hi_Treated_DMEM,groupMDM2Lo_Treated_DMEM)}

\hlstd{HiLoUTSTDPFish}\hlkwb{<-}\hlkwd{classFishersAnalysis}\hlstd{(groupMDM2Hi_Untreated_STDP,groupMDM2Lo_Untreated_STDP)}
\hlstd{TrUnLoDMEM}\hlkwb{<-}\hlkwd{classFishersAnalysis}\hlstd{(groupMDM2Lo_Treated_DMEM,groupMDM2Lo_Untreated_DMEM)}
\end{alltt}
\end{kframe}
\end{knitrout}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{library}\hlstd{(scales)}
\end{alltt}


{\ttfamily\noindent\itshape\color{messagecolor}{\#\# \\\#\# Attaching package: 'scales'}}

{\ttfamily\noindent\itshape\color{messagecolor}{\#\# The following object is masked from 'package:purrr':\\\#\# \\\#\#\ \ \ \  discard}}

{\ttfamily\noindent\itshape\color{messagecolor}{\#\# The following object is masked from 'package:readr':\\\#\# \\\#\#\ \ \ \  col\_factor}}\begin{alltt}
\hlstd{T_test_results_composition}\hlkwb{<-}\hlkwd{table}\hlstd{(T_test_results_sig}\hlopt{$}\hlstd{class)}
\hlstd{T_test_results_composition}\hlkwb{<-}\hlkwd{data.frame}\hlstd{(}\hlkwc{class}\hlstd{=}\hlkwd{names}\hlstd{(T_test_results_composition),}
                                       \hlkwc{count}\hlstd{=}\hlkwd{as.vector}\hlstd{(T_test_results_composition))}
\hlstd{T_test_results_composition} \hlkwb{<-} \hlstd{T_test_results_composition} \hlopt{%>%} \hlkwd{filter}\hlstd{(count}\hlopt{!=}\hlnum{0}\hlstd{)}

\hlstd{bp} \hlkwb{<-} \hlkwd{ggplot}\hlstd{(T_test_results_composition,} \hlkwd{aes}\hlstd{(}\hlkwc{x}\hlstd{=}\hlstr{""}\hlstd{,} \hlkwc{y}\hlstd{=count,} \hlkwc{fill}\hlstd{=class))}\hlopt{+}
\hlkwd{geom_bar}\hlstd{(}\hlkwc{width} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{stat} \hlstd{=} \hlstr{"identity"}\hlstd{)}
\hlstd{pie} \hlkwb{<-} \hlstd{bp} \hlopt{+} \hlkwd{coord_polar}\hlstd{(}\hlstr{"y"}\hlstd{,} \hlkwc{start}\hlstd{=}\hlnum{0}\hlstd{)}
\hlstd{pie}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/compositionPieCharts-1} 

\end{knitrout}

Make a figure out of this (boxplots)

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{abundance} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"GlcCer_NS(d18:1/16:0)"}\hlstd{,groupMDM2Hi_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"Cer(d18:1/16:0)"}\hlstd{,groupMDM2Hi_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"GlcCer_NS(d18:1/16:0)"}\hlstd{,groupMDM2Lo_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"Cer(d18:1/16:0)"}\hlstd{,groupMDM2Lo_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"GlcCer_NS(d18:1/24:1)"}\hlstd{,groupMDM2Hi_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"Cer(d18:1/24:1)"}\hlstd{,groupMDM2Hi_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"GlcCer_NS(d18:1/24:1)"}\hlstd{,groupMDM2Lo_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"Cer(d18:1/24:1)"}\hlstd{,groupMDM2Lo_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"GlcCer_NS(d18:1/25:0)"}\hlstd{,groupMDM2Hi_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"Cer(d18:1/25:0)"}\hlstd{,groupMDM2Hi_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"GlcCer_NS(d18:1/25:0)"}\hlstd{,groupMDM2Lo_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"Cer(d18:1/25:0)"}\hlstd{,groupMDM2Lo_Untreated_DMEM]))}
\hlstd{MDM2_status} \hlkwb{<-} \hlkwd{rep}\hlstd{(}\hlkwd{c}\hlstd{(}\hlkwd{rep}\hlstd{(}\hlstr{"High"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{22}\hlstd{),}\hlkwd{rep}\hlstd{(}\hlstr{"Low"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{12}\hlstd{)),}\hlkwc{times}\hlstd{=}\hlnum{3}\hlstd{)}
\hlstd{ceramide} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlkwd{rep}\hlstd{(}\hlstr{"GlcCer_NS(d18:1/16:0)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{11}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"Cer(d18:1/16:0)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{11}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"GlcCer_NS(d18:1/16:0)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{6}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"Cer(d18:1/16:0)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{6}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"GlcCer_NS(d18:1/24:1)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{11}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"Cer(d18:1/24:1)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{11}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"GlcCer_NS(d18:1/24:1)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{6}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"Cer(d18:1/24:1)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{6}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"GlcCer_NS(d18:1/25:0)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{11}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"Cer(d18:1/25:0)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{11}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"GlcCer_NS(d18:1/25:0)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{6}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"Cer(d18:1/25:0)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{6}\hlstd{))}
\hlstd{pair} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlkwd{rep}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{34}\hlstd{),}\hlkwd{rep}\hlstd{(}\hlnum{2}\hlstd{,}\hlnum{34}\hlstd{),}\hlkwd{rep}\hlstd{(}\hlnum{3}\hlstd{,}\hlnum{34}\hlstd{))}

\hlstd{ceramide_df} \hlkwb{<-} \hlkwd{data.frame}\hlstd{(ceramide,MDM2_status,abundance,pair)}

\hlstd{pvals}\hlkwb{<-}\hlkwd{sapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{3}\hlstd{,}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}
    \hlstd{df} \hlkwb{<-} \hlstd{ceramide_df} \hlopt{%>%} \hlkwd{filter}\hlstd{(pair}\hlopt{==}\hlstd{x)}
    \hlstd{gp1} \hlkwb{<-} \hlstd{df}\hlopt{$}\hlstd{abundance[}\hlnum{1}\hlopt{:}\hlnum{11}\hlstd{]}\hlopt{-}\hlstd{df}\hlopt{$}\hlstd{abundance[}\hlnum{12}\hlopt{:}\hlnum{22}\hlstd{]}
    \hlstd{gp2} \hlkwb{<-} \hlstd{df}\hlopt{$}\hlstd{abundance[}\hlnum{23}\hlopt{:}\hlnum{28}\hlstd{]}\hlopt{-}\hlstd{df}\hlopt{$}\hlstd{abundance[}\hlnum{29}\hlopt{:}\hlnum{34}\hlstd{]}
    \hlstd{res} \hlkwb{<-} \hlkwd{t.test}\hlstd{(gp1,gp2,}\hlstr{"two.sided"}\hlstd{)}
    \hlkwd{return}\hlstd{(res}\hlopt{$}\hlstd{p.value)}
\hlstd{\})}

\hlkwd{library}\hlstd{(cowplot)}
\end{alltt}


{\ttfamily\noindent\itshape\color{messagecolor}{\#\# \\\#\# Attaching package: 'cowplot'}}

{\ttfamily\noindent\itshape\color{messagecolor}{\#\# The following object is masked from 'package:ggplot2':\\\#\# \\\#\#\ \ \ \  ggsave}}\begin{alltt}
\hlstd{plot1}\hlkwb{<-}\hlstd{ceramide_df} \hlopt{%>%} \hlkwd{filter}\hlstd{(pair}\hlopt{==}\hlnum{1}\hlstd{)} \hlopt{%>%}
    \hlkwd{ggplot}\hlstd{(}\hlkwd{aes}\hlstd{(}\hlkwc{x}\hlstd{=MDM2_status,}\hlkwc{y}\hlstd{=abundance,}\hlkwc{fill}\hlstd{=ceramide))} \hlopt{+}
    \hlkwd{geom_boxplot}\hlstd{()} \hlopt{+}
    \hlkwd{facet_wrap}\hlstd{(}\hlopt{~}\hlstd{MDM2_status,} \hlkwc{scale}\hlstd{=}\hlstr{"free"}\hlstd{)} \hlopt{+}
    \hlkwd{theme_classic}\hlstd{()} \hlopt{+}
    \hlkwd{theme}\hlstd{(}\hlkwc{legend.title} \hlstd{=} \hlkwd{element_blank}\hlstd{())} \hlopt{+}
    \hlkwd{ylim}\hlstd{(}\hlnum{15}\hlstd{,}\hlnum{21}\hlstd{)} \hlopt{+}
    \hlkwd{xlab}\hlstd{(}\hlstr{"MDM2 Status"}\hlstd{)} \hlopt{+}
    \hlkwd{ylab}\hlstd{(}\hlstr{"Abundance"}\hlstd{)} \hlopt{+}
    \hlkwd{ggtitle}\hlstd{(}\hlkwd{paste0}\hlstd{(}\hlstr{"Glycosylation ratio of Cer(d18:1/16:0), p="}\hlstd{,} \hlkwd{round}\hlstd{(pvals[}\hlnum{1}\hlstd{],}\hlnum{3}\hlstd{)))}
\hlstd{plot2}\hlkwb{<-}\hlstd{ceramide_df} \hlopt{%>%} \hlkwd{filter}\hlstd{(pair}\hlopt{==}\hlnum{2}\hlstd{)} \hlopt{%>%}
    \hlkwd{ggplot}\hlstd{(}\hlkwd{aes}\hlstd{(}\hlkwc{x}\hlstd{=MDM2_status,}\hlkwc{y}\hlstd{=abundance,}\hlkwc{fill}\hlstd{=ceramide))} \hlopt{+}
    \hlkwd{geom_boxplot}\hlstd{()} \hlopt{+}
    \hlkwd{facet_wrap}\hlstd{(}\hlopt{~}\hlstd{MDM2_status,} \hlkwc{scale}\hlstd{=}\hlstr{"free"}\hlstd{)} \hlopt{+}
    \hlkwd{theme_classic}\hlstd{()} \hlopt{+}
    \hlkwd{theme}\hlstd{(}\hlkwc{legend.title} \hlstd{=} \hlkwd{element_blank}\hlstd{())} \hlopt{+}
    \hlkwd{ylim}\hlstd{(}\hlnum{15}\hlstd{,}\hlnum{20}\hlstd{)} \hlopt{+}
    \hlkwd{xlab}\hlstd{(}\hlstr{"MDM2 Status"}\hlstd{)} \hlopt{+}
    \hlkwd{ylab}\hlstd{(}\hlstr{"Abundance"}\hlstd{)}\hlopt{+}
    \hlkwd{ggtitle}\hlstd{(}\hlkwd{paste0}\hlstd{(}\hlstr{"Glycosylation ratio of Cer(d18:1/24:1), p="}\hlstd{,} \hlkwd{round}\hlstd{(pvals[}\hlnum{2}\hlstd{],}\hlnum{3}\hlstd{)))}
\hlstd{plot3}\hlkwb{<-}\hlstd{ceramide_df} \hlopt{%>%} \hlkwd{filter}\hlstd{(pair}\hlopt{==}\hlnum{3}\hlstd{)} \hlopt{%>%}
    \hlkwd{ggplot}\hlstd{(}\hlkwd{aes}\hlstd{(}\hlkwc{x}\hlstd{=MDM2_status,}\hlkwc{y}\hlstd{=abundance,}\hlkwc{fill}\hlstd{=ceramide))} \hlopt{+}
    \hlkwd{geom_boxplot}\hlstd{()} \hlopt{+}
    \hlkwd{facet_wrap}\hlstd{(}\hlopt{~}\hlstd{MDM2_status,} \hlkwc{scale}\hlstd{=}\hlstr{"free"}\hlstd{)} \hlopt{+}
    \hlkwd{theme_classic}\hlstd{()} \hlopt{+}
    \hlkwd{theme}\hlstd{(}\hlkwc{legend.title} \hlstd{=} \hlkwd{element_blank}\hlstd{())} \hlopt{+}
    \hlkwd{ylim}\hlstd{(}\hlnum{17}\hlstd{,}\hlnum{23}\hlstd{)} \hlopt{+}
    \hlkwd{xlab}\hlstd{(}\hlstr{"MDM2 Status"}\hlstd{)} \hlopt{+}
    \hlkwd{ylab}\hlstd{(}\hlstr{"Abundance"}\hlstd{)} \hlopt{+}
    \hlkwd{ggtitle}\hlstd{(}\hlkwd{paste0}\hlstd{(}\hlstr{"Glycosylation ratio of Cer(d18:1/25:0), p="}\hlstd{,} \hlkwd{round}\hlstd{(pvals[}\hlnum{3}\hlstd{],}\hlnum{3}\hlstd{)))}

\hlcom{#pdf("~/Desktop/Liposarcoma project/final_figures/Ceramide_glycosylation.pdf",height=12,width=8)}
\hlkwd{plot_grid}\hlstd{(plot1,}
          \hlstd{plot2,}
          \hlstd{plot3,}
          \hlkwc{ncol}\hlstd{=}\hlnum{1}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/ReactionAnalysis-1} 
\begin{kframe}\begin{alltt}
\hlcom{#dev.off()}

\hlstd{ratio} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"GlcCer_NS(d18:1/16:0)"}\hlstd{,groupMDM2Hi_Untreated_DMEM])}\hlopt{-}\hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"Cer(d18:1/16:0)"}\hlstd{,groupMDM2Hi_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"GlcCer_NS(d18:1/16:0)"}\hlstd{,groupMDM2Lo_Untreated_DMEM])}\hlopt{-}\hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"Cer(d18:1/16:0)"}\hlstd{,groupMDM2Lo_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"GlcCer_NS(d18:1/24:1)"}\hlstd{,groupMDM2Hi_Untreated_DMEM])}\hlopt{-}\hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"Cer(d18:1/24:1)"}\hlstd{,groupMDM2Hi_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"GlcCer_NS(d18:1/24:1)"}\hlstd{,groupMDM2Lo_Untreated_DMEM])}\hlopt{-}\hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"Cer(d18:1/24:1)"}\hlstd{,groupMDM2Lo_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"GlcCer_NS(d18:1/25:0)"}\hlstd{,groupMDM2Hi_Untreated_DMEM])}\hlopt{-}\hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"Cer(d18:1/25:0)"}\hlstd{,groupMDM2Hi_Untreated_DMEM]),}
               \hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"GlcCer_NS(d18:1/25:0)"}\hlstd{,groupMDM2Lo_Untreated_DMEM])}\hlopt{-}\hlkwd{as.numeric}\hlstd{(LM_area[}\hlstr{"Cer(d18:1/25:0)"}\hlstd{,groupMDM2Lo_Untreated_DMEM]))}

\hlstd{MDM2_status} \hlkwb{<-} \hlkwd{rep}\hlstd{(}\hlkwd{c}\hlstd{(}\hlkwd{rep}\hlstd{(}\hlstr{"High"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{11}\hlstd{),}\hlkwd{rep}\hlstd{(}\hlstr{"Low"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{6}\hlstd{)),}\hlkwc{times}\hlstd{=}\hlnum{3}\hlstd{)}
\hlstd{ceramide} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlkwd{rep}\hlstd{(}\hlstr{"Cer(d18:1/16:0)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{11}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"Cer(d18:1/16:0)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{6}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"Cer(d18:1/24:1)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{11}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"Cer(d18:1/24:1)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{6}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"Cer(d18:1/25:0)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{11}\hlstd{),}
              \hlkwd{rep}\hlstd{(}\hlstr{"Cer(d18:1/25:0)"}\hlstd{,}\hlkwc{times}\hlstd{=}\hlnum{6}\hlstd{))}
\hlstd{pair} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlkwd{rep}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{17}\hlstd{),}\hlkwd{rep}\hlstd{(}\hlnum{2}\hlstd{,}\hlnum{17}\hlstd{),}\hlkwd{rep}\hlstd{(}\hlnum{3}\hlstd{,}\hlnum{17}\hlstd{))}

\hlstd{ratio_df} \hlkwb{<-} \hlkwd{data.frame}\hlstd{(ceramide,MDM2_status,ratio,pair)}

\hlstd{plot1}\hlkwb{<-}\hlstd{ratio_df} \hlopt{%>%} \hlkwd{filter}\hlstd{(pair}\hlopt{==}\hlnum{1}\hlstd{)} \hlopt{%>%}
    \hlkwd{ggplot}\hlstd{(}\hlkwd{aes}\hlstd{(}\hlkwc{x}\hlstd{=MDM2_status,}\hlkwc{y}\hlstd{=ratio,}\hlkwc{fill}\hlstd{=MDM2_status))} \hlopt{+}
    \hlkwd{geom_boxplot}\hlstd{()} \hlopt{+}
    \hlkwd{theme_classic}\hlstd{()} \hlopt{+}
    \hlkwd{theme}\hlstd{(}\hlkwc{axis.text.x} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{12}\hlstd{),}\hlkwc{axis.title.x} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{18}\hlstd{),}
          \hlkwc{axis.text.y} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{12}\hlstd{),}\hlkwc{axis.title.y} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{14}\hlstd{),}
          \hlkwc{plot.title} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{22}\hlstd{))} \hlopt{+}
    \hlkwd{xlab}\hlstd{(}\hlstr{"MDM2 Status"}\hlstd{)} \hlopt{+}
    \hlkwd{ylab}\hlstd{(}\hlstr{"log2(Glycosylated/Nonglycosylated)"}\hlstd{)} \hlopt{+}
    \hlkwd{ggtitle}\hlstd{(}\hlkwd{paste0}\hlstd{(}\hlstr{"Cer(d18:1/16:0), p="}\hlstd{,} \hlkwd{round}\hlstd{(pvals[}\hlnum{1}\hlstd{],}\hlnum{3}\hlstd{)))} \hlopt{+}
    \hlkwd{scale_fill_manual}\hlstd{(}\hlkwc{values}\hlstd{=}\hlkwd{c}\hlstd{(}\hlstr{"red"}\hlstd{,}\hlstr{"blue"}\hlstd{))} \hlopt{+}
    \hlkwd{guides}\hlstd{(}\hlkwc{fill} \hlstd{=} \hlnum{FALSE}\hlstd{)}
\hlstd{plot2}\hlkwb{<-}\hlstd{ratio_df} \hlopt{%>%} \hlkwd{filter}\hlstd{(pair}\hlopt{==}\hlnum{2}\hlstd{)} \hlopt{%>%}
    \hlkwd{ggplot}\hlstd{(}\hlkwd{aes}\hlstd{(}\hlkwc{x}\hlstd{=MDM2_status,}\hlkwc{y}\hlstd{=ratio,}\hlkwc{fill}\hlstd{=MDM2_status))} \hlopt{+}
    \hlkwd{geom_boxplot}\hlstd{()} \hlopt{+}
    \hlkwd{theme_classic}\hlstd{()} \hlopt{+}
    \hlkwd{theme}\hlstd{(}\hlkwc{axis.text.x} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{12}\hlstd{),}\hlkwc{axis.title.x} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{18}\hlstd{),}
          \hlkwc{axis.text.y} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{12}\hlstd{),}\hlkwc{plot.title} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{22}\hlstd{))} \hlopt{+}
    \hlkwd{xlab}\hlstd{(}\hlstr{"MDM2 Status"}\hlstd{)} \hlopt{+}
    \hlkwd{ylab}\hlstd{(}\hlstr{""}\hlstd{)} \hlopt{+}
    \hlkwd{ggtitle}\hlstd{(}\hlkwd{paste0}\hlstd{(}\hlstr{"Cer(d18:1/24:1), p="}\hlstd{,} \hlkwd{round}\hlstd{(pvals[}\hlnum{2}\hlstd{],}\hlnum{3}\hlstd{)))} \hlopt{+}
    \hlkwd{scale_fill_manual}\hlstd{(}\hlkwc{values}\hlstd{=}\hlkwd{c}\hlstd{(}\hlstr{"red"}\hlstd{,}\hlstr{"blue"}\hlstd{))} \hlopt{+}
    \hlkwd{guides}\hlstd{(}\hlkwc{fill} \hlstd{=} \hlnum{FALSE}\hlstd{)}
\hlstd{plot3}\hlkwb{<-}\hlstd{ratio_df} \hlopt{%>%} \hlkwd{filter}\hlstd{(pair}\hlopt{==}\hlnum{3}\hlstd{)} \hlopt{%>%}
    \hlkwd{ggplot}\hlstd{(}\hlkwd{aes}\hlstd{(}\hlkwc{x}\hlstd{=MDM2_status,}\hlkwc{y}\hlstd{=ratio,}\hlkwc{fill}\hlstd{=MDM2_status))} \hlopt{+}
    \hlkwd{geom_boxplot}\hlstd{()} \hlopt{+}
    \hlkwd{theme_classic}\hlstd{()} \hlopt{+}
    \hlkwd{theme}\hlstd{(}\hlkwc{axis.text.x} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{12}\hlstd{),}\hlkwc{axis.title.x} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{18}\hlstd{),}
          \hlkwc{axis.text.y} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{12}\hlstd{),}\hlkwc{plot.title} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size}\hlstd{=}\hlnum{22}\hlstd{))} \hlopt{+}
    \hlkwd{xlab}\hlstd{(}\hlstr{"MDM2 Status"}\hlstd{)} \hlopt{+}
    \hlkwd{ylab}\hlstd{(}\hlstr{""}\hlstd{)} \hlopt{+}
    \hlkwd{ggtitle}\hlstd{(}\hlkwd{paste0}\hlstd{(}\hlstr{"Cer(d18:1/25:0), p="}\hlstd{,} \hlkwd{round}\hlstd{(pvals[}\hlnum{3}\hlstd{],}\hlnum{3}\hlstd{)))} \hlopt{+}
    \hlkwd{scale_fill_manual}\hlstd{(}\hlkwc{values}\hlstd{=}\hlkwd{c}\hlstd{(}\hlstr{"red"}\hlstd{,}\hlstr{"blue"}\hlstd{))} \hlopt{+}
    \hlkwd{guides}\hlstd{(}\hlkwc{fill} \hlstd{=} \hlnum{FALSE}\hlstd{)}

\hlkwd{pdf}\hlstd{(}\hlstr{"~/Desktop/Liposarcoma project/final_figures/Ceramide_glycosylation.pdf"}\hlstd{,}\hlkwc{height}\hlstd{=}\hlnum{4}\hlstd{,}\hlkwc{width}\hlstd{=}\hlnum{16}\hlstd{)}
\hlkwd{plot_grid}\hlstd{(plot1,}
          \hlstd{plot2,}
          \hlstd{plot3,}
          \hlkwc{ncol}\hlstd{=}\hlnum{3}\hlstd{)}
\hlkwd{dev.off}\hlstd{()}
\end{alltt}
\begin{verbatim}
## pdf 
##   2
\end{verbatim}
\end{kframe}
\end{knitrout}

\end{document}



