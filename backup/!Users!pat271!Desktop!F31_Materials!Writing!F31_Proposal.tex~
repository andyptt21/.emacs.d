% Created 2019-12-05 Thu 16:35
% Intended LaTeX compiler: pdflatex
\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage[margin=0.5in]{geometry}
\usepackage{helvet}
\usepackage{enumitem}
\usepackage{wrapfig}
\usepackage[font=small,labelfont=bf]{caption}
\renewcommand{\familydefault}{\sfdefault}
\usepackage{titlesec}
\titlespacing\section{0pt}{12pt plus 4pt minus 2pt}{0pt plus 2pt minus 2pt}
\titlespacing\subsection{0pt}{12pt plus 4pt minus 2pt}{0pt plus 2pt minus 2pt}
\titlespacing\subsubsection{0pt}{12pt plus 4pt minus 2pt}{0pt plus 2pt minus 2pt}
\setlist[itemize]{noitemsep, topsep=0pt}
\usepackage[table]{xcolor}
\usepackage{caption}
\captionsetup{belowskip=0pt}
\setlength{\intextsep}{0mm}
\author{Patt}
\date{\today}
\title{}
\hypersetup{
 pdfauthor={Patt},
 pdftitle={},
 pdfkeywords={},
 pdfsubject={Rough draft for specific aims of F31 application},
 pdfcreator={Emacs 26.3 (Org mode 9.2)}, 
 pdflang={English}}
\begin{document}


\section*{\textbf{SPECIFIC AIMS}}
\label{sec:org2cf6694}

Advances in mass spectrometry techniques used to analyze the
metabolome and lipidome have allowed researchers to collect increasing
quantities of metabolomic data. However, the sparsity of functional
annotations in metabolites, and to a larger extent lipids, have
hindered the ability to interpret the functional impact of metabolomic
and lipidomic profiles. To address issues with pathway coverage in
metabolomics, our group has developed the Relational database of
Metabolic Pathways (RaMP) \cite{RaMP}, which harmonizes pathway
information from multiple major pathway databases including KEGG
\cite{KEGG1,KEGG2,KEGG3}, Wikipathways \cite{Wikipathways}, Reactome
\cite{Reactome}, and HMDB \cite{HMDB,HMDB2,HMDB3,HMDB4}. Due to the
immense structural diversity of lipids, coverage for lipids in these
databases is lagging. Efforts are underway to improve the
interpretation of lipidomic data, as illustrated by the recent
expansion of lipid pathways in Wikipathways \cite{Wikipathways}, HMDB
\cite{HMDB,HMDB2,HMDB3,HMDB4}, and MetaCyc \cite{MetaCyc}. Obtaining
comprehensive information on lipids of interest is laborious, as
annotations are scattered among many different resources. Further
efforts are needed to improve the accessibility and usability of lipid
functional annotations.

Additionally, metabolomic studies suffer from a lack of
reproducibility, particularly on the individual metabolite/lipid
(analyte) level, which is largely why confirmation of metabolites as
biomarkers remains a bottleneck in the field
\cite{pmid22034100}. Experiments capture only a small portion of the
overall metabolome, and the coverage provided by different platfrms is
highly variable. Pathways tend to be more reproducible across
biological samples than variances in individual analytes
[REF]. However, current pathway overrepresentation analysis (ORA)
techniques treat biological pathways as independent, even though
pathways are highly redundant and interconnected \cite{PathMe}. Network
methods can be used to model these interdependencies and improve upon
conventional methods \cite{Crosstalker}. Methods for combining networks
\cite{pmid24464287} will allow us to build similarity networks on
multiple annotation types and unite them into a consensus analyte
similarity model, maximizing annotation coverage for improved ORA.

Our central hypotheses are that \uline{1) combining multiple sources of lipid
annotations will improve coverage (proportion of lipids annotated vs
not) and depth (number of annotation types per lipid) of lipids, and
will make ORA methods more insightful compared to using a single
database resource,} and \uline{2) integrating multiple types and sources of
annotations for metabolite network-based enrichment analysis will
improve detection of enriched metabolite functions over existing ORA
methods, by improving annotation coverage and modeling pathway
redundancies.} Our specific aims are to:

\textbf{Aim 1: Expand and improve usability of lipid annotations within RaMP
from multiple sources}. Lipid annotations are generally distributed
among many resources that are developed in silo, requiring researchers
to separately query each. \uline{We hypothesize that integrating these
annotations into a single source will improve usability, coverage, and
depth of lipid annotations, and will ultimately improve biological
insight gained from performing lipid enrichment analysis.} We will
build a comprehensive lipid knowledgebase that aggregates information
from multiple databases including SwissLipids \cite{SwissLipids}, the
LION/Web lipid ontology \cite{LION/Web}, LipidPedia \cite{Lipidpedia}, and
Lipid Maps \cite{LipidMaps}. Annotations describing pathways, reactions,
chemical structure, biochemical properties, and tissue/subcellular
location will be included. This resource will be designed to support
user-friendly batch queries of lipids as well as lipid functional
analysis, including ORA. We will also develop a novel method to
visualize pathway coverage from user-supplied data, helping users
visualize what biological concepts are represented in their data. The
database and methods will be made accessible in an open-source R
package and Shiny web app \cite{shiny}, including extensive
documentation and example datasets.

\textbf{Aim 2: Develop a novel network-based pathway and annotation enrichment
method that integrates multiple sources of metabolite/lipid
annotations.} Conventional pathway enrichment methods for metabolites
wrongly assume that pathways are statistically independent. To address
this, we will build MetaboSPAN: Metabolite Structure, Pathways, and
Annotation Networks. \uline{We hypothesize that building network models that
incorporate different types of information on shared annotations
between metabolites/lipids will improve the detection of biologically
relevant pathways.} We will apply MetaboSPAN to identify clusters of
analytes that are enriched for a user-supplied list of altered
metabolites, and will test clusters for enrichment of pathways,
chemical class, and biological functions (e.g. membrane fluidity,
energy storage). RaMP \cite{RaMP} will serve as an ideal source for the
annotations required to build these networks, although other databases
can be used. The method will be validated through the use of simulated
data sets, as well as existing enrichment analysis tools like
MetaboAnalyst \cite{Metaboanalyst} and RaMP \cite{RaMP}. Additionally, we
have generated a metabolomic/lipidomic dataset of patient-derived
dedifferentiated liposarcoma cell lines in collaboration with
Dr. James Chen (see LOR) that we will use for biological validation of
the proposed approach. An associated R package and interactive Shiny
web app \cite{shiny} with tutorials and sample data will be created to
improve the user-friendliness of the proposed method.

\newpage
\begin{large}
\textbf{RESEARCH STRATEGY}

\textbf{SIGNIFICANCE}
\end{large}

\textbf{Metabolomics and lipidomics are fields of increasing interest, yet the
lack of standard and centralized information about metabolites and
lipids makes data interpretation challenging:} Advances in UHPLC-MS and
GC-MS technologies are driving the generation of increasingly large
cohorts of metabolomic and lipidomic data. Lipids are an interesting
subset of metabolites, owing to their role in diverse functions such
as membrane fluidity, signaling and energy storage. Interest in
characterizing the metabolome and lipidome are increasing, as they
reflect downstream effects from the transcriptome and proteome, as
well as interactions with the environment (exposome), disease, and
even the microbiome [REF]. As such, the metabolome is a relatively
untapped potential source for novel biomarkers and therapeutic
targets. Diseases with previously described interactions with the
metabolome include, but are not limited to, obesity
\cite{pmid28301839,pmid27314051}, diabetes
\cite{pmid27314051,pmid26883715}, cardiovascular disease
\cite{pmid28007146,pmid27103630}, inflammation/autoimmune diseases
\cite{pmid26166315,pmid25248433,pmid31071242}, asthma \cite{pmid24162911}, and various
cancer subtypes \cite{pmid24316975,pmid23918603}.

\textbf{Pathway analysis of lipidomic and metabolomic data is challenging:} A
common strategy in 'omic settings is to perform pathway analysis to
observe higher-level signatures in analyte (metabolite, lipid, etc.)
expression. Metabolic pathway databases (KEGG \cite{KEGG1,KEGG2,KEGG3},
HMDB \cite{HMDB,HMDB2,HMDB3,HMDB4}, WikiPathways \cite{Wikipathways},
Reactome \cite{Reactome}, MetaCyc \cite{MetaCyc}) link to tools for ORA
(e.g. Lipea \cite{Lipea} for KEGG, Metaboanalyst \cite{Metaboanalyst} for
HMDB), but suffer from limited pathway coverage for lipids. Lipids
have low pathway annotation coverage because of their highly
heterogeneous structure, driven by differences in head group, fatty
acyl side chain length, etc. As such, many pathway databases store
pathway information for generic lipid classes by head group, providing
annotations at a lower structural resolution than what is generated by
most LC-MS platforms. This scheme necessarily entails a loss of
information. Due to their low pathway coverage, it can be useful to
analyze different annotation schemes for lipids, such as chemical
structure or biological function. Resources for other annotation
schemes are already available, yet they are not
comprehensive. Resources for general lipid annotations (Lipid Maps
\cite{LipidMaps}, SwissLipids \cite{SwissLipids}, LION/Web \cite{LION/Web}
and Lipidpedia \cite{Lipidpedia}) are highly variable in their size,
linked databases, and annotations contained. Further, they are
intended for individual queries of lipid species, and do not link to
user-friendly software for batch queries of lipids that can be used
for ORA. Thus, we aim to improve coverage of mappable lipids by
incorporating information from various lipid knowledgebases, which
could be used as input for functional analysis of these data.

An additional issue is that current ORA tools assume biological processes are
independent, when in reality, metabolite/lipid relationships and their
biological annotations are interdependent and redundant. Different
types of annotations describe metabolites/lipids, such as chemical,
biological, etc. Modeling interdependencies between multiple
information types better reflects the biology underlying experimental
data. Combining multiple annotation types from multiple sources
maximizes coverage of lipids mapping to annotations. Our proposed
network approach aims to identify biologically relevant subnetworks
that are enriched for analytes of interest.

\begin{wraptable}{r|l}{.6\textwidth}

\begin{center}
\includegraphics[width=.9\linewidth]{../Figures/table1.pdf}
\end{center}

\textbf{Table 1:} Lipidomic annotations are unevenly distributed among many
distinct sources. "Functional annotations" refers to annotations for biological function
(e.g. membrane fluidity, energy storage), or subcellular/tissue
location

\end{wraptable}

\textbf{Pathway-level analysis of the lipidome/ metabolome infer reproducible
biological processes associated with disease:} A common goal of
metabolomic/ lipidomic studies is to identify predictive metabolite
biomarkers that are associated with prognosis, disease progression or
treatment response in patients. However, reproducibility of findings
at the metabolite level across experiments have limited the number of
metabolite biomarkers that have influenced clinical practice
\cite{pmid22034100}. Low reproducibility in individual measurements are due to
natural biological variation between samples, differences in
metabolite coverage between data acquisition platforms, and redundancy
in the biological function of analytes. One strategy for overcoming
this reproducibility is to look for differences between samples on a
pathway level. Previous studies have identified consistent
dysregulated pathways where individual analytes did not show
concordant alterations. Examples include the analysis of metabolomic
profiles across tissues and cohorts[REF,31236709], analysis of
metabolomic data in adenocarcinoma [REF], and analysis of metabolomics
in asthma[REF]. Developing methodology for improved detection of
pathways altered by disease could thus improve the reproducibility of
findings in the search for robust drivers of disease.

\textbf{Tools for network visualization and analysis of lipid/metabolite data
are needed:} A recent review \cite{pmid31003499} identified the need for
more comprehensive open source pathway databases and network
visualization tools. A variety of tools are available for
pathway/functional analysis of lipidomic/metabolomic data. Many
lipidomic tools (the LION/Web enrichment tool \cite{LION/Web}, Lipid
Mini-On \cite{LipidMini-on}) are focused on enrichment of functional
terms, as coverage for pathways in major pathway databases has lower
coverage. Alternatively, Lipea, a specialized tool for mapping
lipidomic data to KEGG pathways, does not consider the lipid
functional and chemical annotations being leveraged by other lipidomic
tools. There are a wide variety of tools for pathway analysis of
metabolomic data, such as Metaboanalyst \cite{Metaboanalyst}, and the
current RaMP R package/Shiny app \cite{RaMP} - however, in the lipidomic
context, these suffer from the lack of lipid pathway annotations, and
none link to the special lipid annotation resources listed in \textbf{Table
1}. An alternative strategy to address a lack of pathway annotations is
to perform chemical structure enrichment analysis, as is done by
ChemRich \cite{ChemRich} and Metabox \cite{MetaBox}. However, many of
these tools do not consider the underlying biology on the network
level (Metaboanalyst,ChemRich, RaMP), which better models the complex
interplay of metabolites than analyzing them in silo, and none combine
functional, chemical and pathway information into a single,
user-friendly analysis tool. Interactive visualization of these
networks allows users to quickly retrieve relevant information. Our
team has extensive experience in interactive visualization and in R
Shiny web interfaces \cite{RaMP,IntLIM,ALTRE}.

\begin{large}
\textbf{INNOVATION}
\end{large}

\begin{itemize}
\item \textbf{Comprehensive, multi-source lipid annotation database:} We propose to
integrate multiple lipid information sources into a single public,
user-friendly resource. To the best of our knowledge, there is no
such database publicly available. We hypothesize that this updated
RaMP database will increase mappability of lipids to their
biological functions which will in turn facilitate lipid functional
analysis for biomedical researchers.  This resource will
significantly ease the process of lipid functional analysis for
biomedical researchers and bridge siloed annotation systems.
\item \textbf{Integrating multiple annotation types into a single enrichment
strategy:} Current enrichment methods use a single information type
(e.g. KEGG pathways, chemical classes, etc.).  Yet, leveraging
multiple information types provides multiple viewpoints of a
biological system, and we believe it will improve biological
insight.  To accomplish this, we propose to develop a novel method
for network-based pathway analysis that leverages multiple sources
of analyte annotations and biological functions (e.g. membrane
fluidity, energy storage). This method will output a ranked list of
enriched pathways, chemical classes and biological functions
identified in modules in the consensus network model. This strategy
will maximize the coverage of annotations associated with user data,
improving biological insight.
\item \textbf{Modeling interdependency of pathways:} Current pathway analysis
strategies treat biological pathways as statistically independent,
when in reality they are highly overlapping in their metabolite
composition. Our proposed network strategy addresses this false
assumption. Treating pathways as dependent will improve the
relevancy of statistical results
\item \textbf{Network visuals of pathway and analyte similarity:} We will provide
users with a network visual of pathways that represent their data,
and will provide interactive visuals of consensus networks that
integrate multiple sources and types of annotations.  These
interactive visualizations will help users infer biological concepts
that underlie and are enriched in their input data.
\end{itemize}

\begin{large}
\textbf{EXPERIMENTAL APPROACH}

\textbf{Aim 1 - Expand and improve usability of lipid annotations within RaMP from multiple sources}
\end{large}

\textbf{Rationale:} Many resources exist for annotating lipids with chemical
structures, biological pathway associations, biochemical reactions,
biological function, and subcellular/tissue location. Integrating
these annotations will significantly ease the process of lipid
functional analysis for biomedical researchers and bridge siloed
annotation systems. An updated RaMP database will provide a rich
resource for building lipid and metabolite chemical, functional and
pathway similarity networks.

\textbf{Aim 1 Preliminary Findings}

We analyzed the contents of the RaMP \cite{RaMP} database and found that
biological annotations from commonly used resources (KEGG
\cite{KEGG1,KEGG2,KEGG3}, WikiPathways \cite{Wikipathways}, Reactome
\cite{Reactome}, and HMDB \cite{HMDB,HMDB2,HMDB3,HMDB4}) are only
available for \textasciitilde{}20\% of metabolites. We further found that information
in these databases were highly distinct; for example, 98.1\% of
metabolites in HMDB were not found in any other database, while the
same was true for 47.5\% of metabolites in KEGG, 30.4\% in Wikipathways,
and 15.1\% in Reactome. We hypothesize that the same will hold true for the lipid
resources we will integrate into RaMP. It is thus critical to combine multiple
sources of information to increase mapping of analyte to annotations,
and to improve biological interpretation of lipidomic data. 

\begin{wrapfigure}{r}{0.68\textwidth}
\centering
\includegraphics[width=0.7\textwidth]{../Figures/Network_fig2.pdf}
\caption{Pathway coverage of metabolites in our liposarcoma dataset using the current RaMP database}
\end{wrapfigure} 

In \textbf{Subaim 1c}, we aim to create a visualization tool where one can
evaluate the global biological context of their experiment through
pathways and annotations represented in a user-input list of
analytes. We generated a pathway-pathway network from a list of 481
metabolites that are measured in six different patient-derived
dedifferentiated liposarcoma tumor cell lines (also used in \textbf{Aim 2b}). A
total of 1,054 pathways were used, representing pathways from RaMP
that contained between 5 and 500 metabolites and at least one
metabolite from the list of 481 common metabolites. Edge weights of
the network represent the similarity between two pathways, using a
Fisher’s Exact test to ascertain whether the proportion of metabolites
in one pathway is higher among metabolites in another pathway than we
would expect by chance. Edge weights with a Fisher's p > 0.95 were set
to zero, eliminating 58\% of edges. The resultant graph was clustered
using the Louvain algorithm \cite{Louvain} and 4 pathway modules were
identified. To interpret modules and validate whether our approach
accurately clusters biologically related pathways together, we
assigned biological concepts (e.g. amino acid metabolism) from BRITE
pathway maps \cite{KEGG1,KEGG2,KEGG3} for KEGG pathways in the
network. We tested whether terms associated with the pathways were
overrepresented in each module compared to the rest of the network
(FDR-adjusted Fisher’s Exact test p<0.1). Six terms were significantly
enriched for three of the four identified modules (\textbf{Figure 1}), with
each term representing multiple pathways. For example, the red module
was enriched for “Amino Acid Metabolism”, representing 12 different
pathways, and to the closely related term “Carbohydrate Metabolism”,
representing 5 pathways. Interestingly, the WikiPathways (WP) “Amino
Acid Metabolism” pathway (WP3925) was found in this cluster as well,
even though WP pathways do not map to the BRITE hierarchy. Similarly,
in the blue cluster, which contained four pathways, the three
wikipathways pathways "Phospholipid biosynthesis" (WP2457),
"Phosphatidylcholine catabolism" (WP4195), and "Sphingolipid
Metabolism" (WP1422) clustered with the KEGG pathway "Sphingolipid
Metabolism" (hsa00600). The appropriate mapping of WikiPathways
annotations with biologically sound BRITE annotations validates the
accuracy and relevance of our data driven network approach to
clustering pathways.

\textbf{\uline{Subaim 1a:} Consolidate lipid annotations in RaMP from lipid databases} 

Currently, RaMP includes metabolite and transcript pathway information
from HMDB \cite{HMDB,HMDB2,HMDB3,HMDB4}, KEGG \cite{KEGG1,KEGG2,KEGG3},
Reactome \cite{Reactome} and Wikipathways \cite{Wikipathways}.  We will
renovate RaMP by incorporating seven different types of
information: 1) chemical structure in the form of INChiKeys
\cite{pmid26136848}, 2) chemical classes (e.g. ceramides,
phosphocholines) 3) context, (e.g. subcellular or tissue location), 4)
chemical/physical properties (e.g. headgroup charge, bilayer
thickness), 5) biological function (e.g. signaling, storage), 6)
disease, and 7) biochemical reactions.  This information will be drawn
from four sources: LION/Web \cite{LION/Web} which contains >250,000
annotations for >50,000 lipids, including lipid class, subcellular
location, biological function, and biochemical/physical properties;
SwissLipids \cite{SwissLipids}, which contains location, reaction,
structure and chemical class annotations for 777,657 lipids (real and
theoretical); Lipid Maps \cite{LipidMaps}, which contains structure and
chemical class annotations for 43,636 lipids; and Lipidpedia
\cite{Lipidpedia} which contains disease, MeSH term, function, and
reactions for 4,487 lipids.  Information from aforementioned source
databases will be merged into one relational database to support: 1)
individual queries: search information about one pathway or one
lipid/metabolite, 2) batch queries: retrieve pathways associated with
a list of metabolites/lipids, and vice versa, and 3) complex queries:
metabolites/lipids involved in multiple pathways. Users will have
access to the code (via GitHub) needed to recreate the database on
another system. The new proposed database and queries will be embedded
into the RaMP-DB R package, which includes a user-friendly R shiny web
interface that can be run on a local server or through the OSU
Biomedical Informatics servers (ramp-db.bmi.osumc.edu).

\textbf{\uline{Subaim 1b:} Improve usability of known lipid annotations by implementing conventional ORA software for expanded lipidomic
knowledgebase}

Software for conventional enrichment analysis based off the Fisher's
Exact test or Hypergeometric test is made available in a wide variety
of popular metabolomic analysis tools such as Metaboanalyst
\cite{Metaboanalyst} and RaMP \cite{RaMP}. Pathway and annotation
enrichment analyses are complimentary to the network analysis proposed
in \textbf{Aim 2}. The results of these enrichment analyses are restricted to
the pathways or annotations that map to user supplied data, which are
stored in the underlying database for the analysis. Therefore, our
comprehensive lipid knowledgebase will have the potential to test for
an expanded list of annotations compared to other tools which draw
from a single source. Users will be given the option to test for
enrichment of any of the seven new annotation types being added to the
renovated RaMP (\textbf{Aim 1a}), with the option of comparing their enriched
analyte list to a custom background panel based on their experimental
data, or using the entire database as background. Both the Fisher's
Exact test and hypergeometric test will be included as options for
statistical enrichment analysis of user data, as well as MSEA-style
analysis based off the Kolmogorov/Smirnov statistic \cite{pmid20457745}. This
functionality will be included as part of the proposed
MetaboSPAN package proposed in \textbf{Aim 2c}.

\textbf{\uline{Subaim 1c:} Develop methodology for the visualization of coverage of
pathways in user-supplied data} 

We propose to develop an interactive tool to visualize relationships
between pathways. Users will be able to define the following options
in their visualization: 1) pathway source(s) to include: KEGG,
WikiPathways, etc., 2) analyte annotation sources to include,
e.g. chemical annotations, biological function, etc., and 3) an input
list of analytes so that only pathway annotations related to their
input list of analytes are retrieved. This tool will allow users to
understand what biological functions are represented in their measured
lipids, which is the first step in interpreting the data. To visualize
relationships between pathways defined by the user, we propose to
build a network graph where nodes are pathways or analyte annotations,
and edges represent the extent of analytes shared between two
nodes. The weights of edges are defined as 1 - p, where p is the
p-value resulting from a Fisher’s Exact Test, which we have found to
be less correlated with pathway size than other metrics (e.g. Jaccard
and Soergel distances, unpublished). From this experiment-specific
network, weak nodes (e.g. containing < 5 pathways) and edges are
filtered out (e.g. weights < 0.05). Submodules are then detected by
applying a Louvain algorithm \cite{Louvain}, a commonly used algorithm
for network analysis to segment a network into optimal
modules. Intuitively, each resulting module represents a group of
pathways that share similar analytes. Modules are then labeled with
higher level biological concepts, such as with those obtained from BRITE
ontologies \cite{KEGG1,KEGG2,KEGG3}, that show a significant statistical
enrichment in lipids that are in the module.

\textbf{Expected Outcomes:} RaMP \cite{RaMP} is a powerful metadatabase that provides
a bridge between multiple databases to enhance the number of analytes
mapping to biological pathways and annotations. We propose to extend
this functionality to the lipidomics field by integrating information
from Lipid Maps, Swiss Lipids, LipidPedia and LION/Web, thereby
significantly increasing the coverage of species that can be mapped to
biological functions and annotations. The results of \textbf{Aim 1} will
provide a unique resource for annotation of individual and batch
queries of lipids, conventional enrichment analysis, and network
visualization, that emphasizes interactivity and user
friendliness. Additionally, completion of this aim will provide a
strong basis for the novel pathway-based enrichment analysis proposed
in \textbf{Aim 2, although the proposed renovation of the RaMP database can be
readily integrated in other tools.}

\textbf{Potential Pitfalls and Solutions:} RaMP is a relational database, and
may thus not scale well as the information within RaMP continues to
grow, which may require server expansion for hosting (available at
BMI). Should this issue arise, noSQL database structures such as
couchDB, where scaling is cheaper (it involves adding more servers,
not restructuring the schema) will be explored. As RaMP grows,
scalability of building a pathway-pathway network itself may be a
limitation. To address this, we provide filtering options on which
analytes and pathways to include, for example by removing very large
pathways (e.g. containing > 500 metabolites) and metabolites involved
in many pathways (e.g. >100). Edges in the network can be precomputed
to further decrease computation time. Lastly, integrating multiple
sources of information is highly dependent on the accuracy of mapping
analyte IDs across databases, which is challenging because databases
use different IDs, with varying levels of information. For example,
metabolites represented by InChIKeys \cite{pmid26136848} uniquely map to one
metabolite while the commonly used ChEBI IDs do not. Standardization
of IDs is thus a huge challenge that is not completely solved,
although it is being tackled by large community-driven initiatives
\cite{pmid20047655,pmid20829444}. We will rely on these efforts to
improve our mappings. Further, results of mapping will be output so
users can evaluate the confidence in their mapping.

\begin{large}
\textbf{Aim 2 - Develop a novel network-based pathway and annotation
enrichment method that integrates multiple sources of metabolite/lipid
annotations}
\end{large}

\textbf{Rationale:} Alternative annotation schemes (chemical structure,
reactions, biological function, tissue/subcellular/biofluid location)
can provide coverage for metabolites/lipids that would be ignored by
conventional pathway ORA, increasing the amount of experimental
information that can be incorporated into enrichment
analysis. Further, current pathway analysis methods based on the
Fisher's exact or hypergeometric test treat pathways as statistically
independent while pathways can share many metabolites or
processes. Network methodology can be used to account for this
interdependency. Lastly, open-source, user-friendly software for
network analysis of metabolomic and lipidomic data is
lacking. Implementing an R package and user-friendly RShiny app will
increase the accessibility of the proposed methodology.

\textbf{Aim 2 Preliminary findings}

In collaboration with Dr. James Chen (see LOS), we generated
metabolomic and lipidomic data in a set of six patient-derived
dedifferentiated liposarcoma cell lines[REF]. Cell lines were
stratified according to copy number of the MDM2 oncogene[REF]. Cell
viability experiments demonstrated that cell lines with low MDM2 copy
number were sensitive to treatment with atorvastatin, while cells with
high MDM2 copy number were not. Further viability experiments
demonstrated that MDM2 high cell lines were sensitive to treatment
with ceramides, lipid drivers of apoptosis [REF]. To identify
metabolites altered by MDM2 amplification, we performed linear mixed
effect modeling [REF], controlling for variation explained by cell
line (FDR adjusted p value < 0.05, |log2 fold change| > 0.75). This
resulted in a list of 17 statistically significant metabolites. \textbf{Figure
2A} shows the result of RaMP pathway analysis on this dataset. This
list of 17 metabolites was then used as input for preliminary
MetaboSPAN analysis. The list of 17 was filtered to 10 metabolites
that mapped to KEGG pathways. These 10 seed nodes were overlaid on a
pathway similarity network of 1,449 metabolites from RaMP that shared
a pathway annotation with at least one member of the seed set. Pathway
similarity was quantified using a Jaccard index of pathway annotations
shared by metabolites connected by an edge. A chemical similarity
network was constructed between this same set of 1,449 metabolites
using a tanimoto score of chemical fingerprint overlap
\cite{ChemRich}. This network was then binarized using a stringent
cutoff, with edges in the 90th percentile or higher of chemical
similarity receiving an edge weight of 1, with all other edge weights
assigned a 0. The two separate similarity networks were then merged by
summing edge weights. We then searched for metabolites significantly
proximal to our "seed set" of 10 using a random walk with restarts
strategy \cite{diffusr}. To control for the connectivity of the network
structure, we ran the algorithm with 10,000 random seed sets of 10,
and compared the score of nodes with the real seed set to the
distribution of random sets. Metabolites that were scored very high
compared to their randomized distribution (97th percentile or higher)
were extracted to form a subnetwork with the seed nodes, shown in
\textbf{Figure 2B}. Last, the Louvain clustering algorithm \cite{Louvain} was
applied, identifying three clusters (red, blue,
green). Clusters were tested separately for pathway
enrichment with RaMP. \textbf{Figure 2C} shows results of pathway analysis
in the red cluster.

\begin{wrapfigure}{r}{0.73\textwidth}
\centering
\includegraphics[width=0.75\textwidth]{../Figures/fig3.pdf}
\caption{Preliminary MetaboSPAN analysis of liposarcoma cell lines. A) Significant metabolites associated with seed set (large, dark nodes). Color corresponds to module by Louvain clustering. B) RaMP pathway analysis with seed set. C) RaMP analysis of red module of MetaboSPAN network.}
\end{wrapfigure}

When performing enrichment analysis on the red module, "Sphingolipid
metabolism" became more significant in the red module (FDR adjusted
pval=0.015) than it was in the seed set (FDR adjusted pval=0.015). An
additional sphingolipid pathway, "Sphingolipid \emph{de novo} biosynthesis",
became significant as well. These were driven by the recruitment of
NADP to the enriched metabolite set by our random walk
strategy. NADP is a common cofactor in anabolic reactions such as
lipid synthesis, and also has high structural homology to uric acid,
which was also part of our seed set, explaining how it was selected by
our algorithm. Interestingly, although NADP was not captured by our
Metabolon panel, its reduced form, NADPH, was highly depleted in MDM2
low compared to high, but missed statistical significance (FDR
adj. pval=0.16, log2FC = 0.90). MetaboSPAN was able to provide additional support for
alterations in sphingolipid metabolism as compared to conventional
methodology, which better reflects our \emph{in vitro} observation that MDM2 higher
cells are sensitive to treatment with ceramides. Further, MetaboSpan
was able to highlight other potential new biological processes altered
by MDM2 status: bile acid synthesis/secretion, and
Prostaglandin/Eicosanoid synthesis. Bile acids are key regulators of
cholesterol homeostasis [REF]. Differences in bile acid production
could explain why MDM2 low cells are sensitive to treatment with
sterol synthesis inhibitors (atorvastatin), while MDM2 high cells are
not. Additionally, bile acids and eicosanoids are both regulators of
inflammation [REF]. Upregulated inflammation is a hallmark of
malignant cancers, which coincides with the observation that
liposarcoma patients with MDM2 high tumors tend to have worse
prognosis than those with low MDM2 amplification. In all, MetaboSPAN
was able to better highlight known biological differences better than
conventional methodology, as well as suggest more biologically
relevant pathways that went undetected by conventional methodology. 

\textbf{\uline{Subaim 2a}: Build a consensus similarity network model from multiple
annotation types using similarity network fusion algorithms.} For all
metabolites/lipids in RaMP, we will construct analyte-analyte
similarity network models where nodes are analytes and edges are
weighted according to the similarity between the nodes they
connect. Similarity network models will be constructed for each
annotation type contained in RaMP. For example, in order to
incorporate pathway information into a similarity network, edges would
represent the number of pathways shared in the RaMP database between
two metabolites, quantified using a Jaccard index as in \textbf{Figure 2.} RaMP
also contains ontological information for metabolites, such as
biofluid, cellular location, or disease association, whose overlap
could also be quantified with a Jaccard index. Finally, a chemical
similarity network will be constructed using a tanimoto similarity
between pubchem fingerprints \cite{pmid26400175} of connected
metabolites. A similar strategy can be used for the unique lipid
annotations that will be incorporated into RaMP as part of \textbf{Aim 1}
(biological function, chemical/physical properties, context from
LION/Web \cite{LION/Web}). This will require the construction of a
separate similarity model for all lipids in RaMP. To combine these
separate similarity models into a consensus model, we propose to use
similarity network fusion (SNF) algorithms \cite{pmid24464287}. SNF
algorithms have been successfully applied in a variety of biomedical
contexts, such as multiomic integration \cite{pmid24464287}, gene
function prediction \cite{pmid27889536}, and survival prediction from
patient data \cite{pmid30872331,pmid29860027}. SNF is
a popular approach for combining data types as it efficiently
preserves strong relationships between nodes (metabolites/lipids in
this case) in one or many models while filtering out noisy, less
relevant relationships in the final output. Although SNF does require
user-input hyperparameters, the final result is robust to parameter
selection \cite{pmid24464287}, making it suitable for our purpose of
building a metabolite similarity model.

\textbf{\uline{Subaim 2b:} Develop methodology for detecting enriched pathways and
annotations in the consensus similarity network}. The output of \textbf{Subaim
2a} will be a similarity network model of all metabolites or lipids in
RaMP. In \textbf{Subaim 2b}, we leverage this model to identify annotations
that are significantly enriched in a list of user-supplied metabolites
or lipids of interest. User supplied lipids or metabolites will be
used as "seeds" for a random walk strategy as described in \textbf{Aim 2
preliminary findings.} Modules output by this analysis will be used for
ORA on each annotation type incorporated into the network model,
including pathway terms, chemical classes, biological function, etc.,
compared to a background of the entire database. To demonstrate the
validity of our proposed approach, we propose a threefold
strategy. First, we plan to continue to cross-reference results in our
liposarcoma data sets with our ongoing \emph{in vitro} experiments performed
in collaboration with Dr. Jim Chen. Secondly, to demonstrate increased
consistency across experiments, we have identified several metabolomic
colon cancer datasets from the Metabolomic Workbench [REFs]. We aim to
apply the method in different datasets to demonstrate the similar
results achieved across cohorts. Lastly, we will utilize a simulated
approach, demonstrating an increased sensitivity by our new approach
to biologically relevant results over conventional ORA in the same
list of analytes where differences in pathways or chemical classes are
already known.

\textbf{\uline{Subaim 2c}: Develop MetaboSPAN: R package/Shiny app for
Metabolite Structure, Pathway, and Annotation Network enrichment
analysis}. In this phase of the project we will construct
an R package and associated RShiny app for the proposed methodology of
aims 1 \& 2. One issue facing the metabolomics community is a lack of
standard protocols for normalizing/filtering metabolomic data
\cite{pmid19185549}. To guide researchers through common preprocessing steps of omic
data analysis, and to promote standard methodology, a number of
functions for preprocessing and visualization of data prior to
performing network analysis will be included. The additional
functionality will include easy uploading of metabolomic and lipidomic
data, log2 abundance transformation, MSTUS normalization
\cite{pmid19185549}, interactive QC of the data through unsupervised
clustering (PCA, Hierarchical), and differential abundance analysis
using fold changes and p values to determine significantly altered
transcripts and metabolites. We will also post all source code on
GitHub, as well as downloadable example data with vignettes to
instruct users. We will consult with metabolomics collaborators such
as Dr. Garrett (see LOS) and Dr. Kopec (see LOR) to ensure that
a wide variety of considerations and needs are addressed by the
software.

\textbf{Expected Outcomes:} Identifying significant modules in our consensus
similarity network using a random walk strategy will account for the
bias in highly connected regions of our graph, which intuitively
translates to groups of metabolites with highly redundant annotations,
such as overlapping pathways. Our approach will filter
out redundant results better than conventional ORA, easing the
interpretation of experimental data. An interactive and user-friendly
tool that provides a standard framework for metabolomic analysis from
unnormalized, unfiltered data to downstream analyses will address two
needs for the metabolomics research community: interpretable analysis
methodology, and standard preprocessing methodology. Writing in R will
allow the package and app to interface easily with the RaMP package as
well as other R packages for statistics and visualization.

\textbf{Potential Pitfalls and Solutions:} Similarity network fusion is
computationally intensive and requires the specification of
hyperparameters, which will require weighting the importance of
different annotation types against each other and potentially biasing
results. We will consider other approaches such as summing edge weights,
which is less computationally intensive, or Grassmann manifolds \cite{pmid30329022}, which
do not require user parameterization. The random walk approach is also
computationally intensive and non-deterministic; we will also
experiment with the use of heat diffusion algorithms \cite{pmid29211807} to identify
modules of nodes associated with seed analytes.

\newpage
\bibliography{../../../Documents/emacs_files/references}
\bibliographystyle{ieeetr}
\end{document}
